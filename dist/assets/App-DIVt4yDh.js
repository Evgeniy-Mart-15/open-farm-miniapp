import{r as f,j as t}from"./index-Bn8SN_Y9.js";function J(){return{level:1,revision:0,resources:{coins:100,gems:5,tomato:0,cucumber:0,corn:0,watermelon:0,apple:0,milk:0,egg:0,cheese:0,meat:0,feathers:0,wool:0,feed:5},crops:[{id:"c1",type:"tomato",level:1,baseYield:3,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!0},{id:"c2",type:"cucumber",level:1,baseYield:2,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!0},{id:"c3",type:"tomato",level:1,baseYield:2,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!0},{id:"c4",type:"corn",level:1,baseYield:3,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!1},{id:"c5",type:"watermelon",level:1,baseYield:4,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!1},{id:"c6",type:"apple",level:1,baseYield:5,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!1}],animals:[{id:"a1",type:"cow",level:1,baseYield:1,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!0},{id:"a2",type:"chicken",level:1,baseYield:1,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!0},{id:"a3",type:"goat",level:1,baseYield:1,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!1},{id:"a4",type:"sheep",level:1,baseYield:1,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!1},{id:"a5",type:"pig",level:1,baseYield:1,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!1},{id:"a6",type:"goose",level:1,baseYield:1,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!1}]}}const Bs=60*1e3;function ss(e){return{startedAt:Date.now(),durationMs:e*Bs}}function zs(e){if(!e)return 0;const r=Date.now()-e.startedAt;return Math.min(1,Math.max(0,r/e.durationMs))}function M(e){return e?Date.now()-e.startedAt>=e.durationMs:!1}function Os(e){const r=J().resources;return e?{...r,...e,coins:typeof e.coins=="number"?e.coins:r.coins,gems:typeof e.gems=="number"?e.gems:r.gems,tomato:typeof e.tomato=="number"?e.tomato:r.tomato??0,cucumber:typeof e.cucumber=="number"?e.cucumber:r.cucumber??0,corn:typeof e.corn=="number"?e.corn:0,watermelon:typeof e.watermelon=="number"?e.watermelon:0,apple:typeof e.apple=="number"?e.apple:0,milk:typeof e.milk=="number"?e.milk:0,egg:typeof e.egg=="number"?e.egg:0,cheese:typeof e.cheese=="number"?e.cheese:0,meat:typeof e.meat=="number"?e.meat:0,feathers:typeof e.feathers=="number"?e.feathers:0,wool:typeof e.wool=="number"?e.wool:0,feed:typeof e.feed=="number"?e.feed:r.feed??5}:{...r}}function Ve(e){const r=J(),o=Array.isArray(e.crops)?e.crops.filter(y=>y!=null&&typeof y=="object"&&y.id!=null):r.crops,c=Array.isArray(e.animals)?e.animals.filter(y=>y!=null&&typeof y=="object"&&y.id!=null):r.animals,d=new Map(o.map(y=>[y.id,y])),g=new Map(c.map(y=>[y.id,y])),p=r.crops.map(y=>{const j=d.get(y.id);return{...y,...j,harvestsSinceLevel:(j==null?void 0:j.harvestsSinceLevel)??0}}),x=r.animals.map(y=>{const j=g.get(y.id);return{...y,...j,harvestsSinceLevel:(j==null?void 0:j.harvestsSinceLevel)??0}}),w=Os(e.resources);return{...e,resources:w,crops:p,animals:x}}function _s(e,r){const o=e.crops.find(x=>x.id===r);if(!o)return e;let c=5;if(o.type==="corn"&&(c=10),o.type==="watermelon"&&(c=15),o.type==="apple"&&(c=20),e.resources.coins<c||o.timer)return e;let d;switch(o.type){case"tomato":d=3;break;case"cucumber":d=5;break;case"corn":d=6;break;case"watermelon":d=8;break;case"apple":d=10;break;default:d=5}const g=o.gemUpgradeLevel??0;return d=d/Math.pow(2,g),{...e,resources:{...e.resources,coins:e.resources.coins-c},crops:e.crops.map(x=>x.id===r?{...x,timer:ss(d)}:x)}}function Ps(e,r){const o=e.animals.find(x=>x.id===r);if(!o)return e;const c=1;if(e.resources.feed<c||o.timer)return e;let d;switch(o.type){case"cow":d=10;break;case"chicken":d=8;break;case"goat":d=9;break;case"sheep":d=9;break;case"pig":d=12;break;case"goose":d=7;break;default:d=10}const g=o.gemUpgradeLevel??0;return d=d/Math.pow(2,g),{...e,resources:{...e.resources,feed:e.resources.feed-c},animals:e.animals.map(x=>x.id===r?{...x,timer:ss(d)}:x)}}function Ds(e,r){const o=e.crops.find(h=>h.id===r);if(!o||!o.timer||!M(o.timer))return e;const c=o.gemUpgradeLevel??0,d=Math.pow(2,c),g=o.baseYield*d,p={...e.resources};o.type==="tomato"?p.tomato+=g:o.type==="cucumber"?p.cucumber+=g:o.type==="corn"?p.corn+=g:o.type==="watermelon"?p.watermelon+=g:o.type==="apple"&&(p.apple+=g);const w=(o.harvestsSinceLevel??0)+1,y=Math.floor(w/5),j=w%5;return{...e,resources:p,crops:e.crops.map(h=>h.id===r?{...h,timer:null,level:h.level+y,harvestsSinceLevel:j}:h)}}function Gs(e,r){const o=e.animals.find(h=>h.id===r);if(!o||!o.timer||!M(o.timer))return e;const c=o.gemUpgradeLevel??0,d=Math.pow(2,c),g=o.baseYield*d,p={...e.resources};o.type==="cow"?p.milk+=g:o.type==="chicken"?p.egg+=g:o.type==="goat"?p.cheese+=g:o.type==="sheep"?p.wool+=g:o.type==="pig"?p.meat+=g:o.type==="goose"&&(p.feathers+=g);const w=(o.harvestsSinceLevel??0)+1,y=Math.floor(w/5),j=w%5;return{...e,resources:p,animals:e.animals.map(h=>h.id===r?{...h,timer:null,level:h.level+y,harvestsSinceLevel:j}:h)}}function Fs(e){const{tomato:r,cucumber:o,corn:c,watermelon:d,apple:g,milk:p,egg:x,cheese:w,meat:y,feathers:j,wool:N}=e.resources,h=D=>Math.round(D*1.25),P=r*h(3)+o*h(4)+c*h(5)+d*h(6)+g*h(6)+p*h(9)+x*h(6)+w*h(11)+y*h(13)+j*h(4)+N*h(7);return P===0?e:{...e,resources:{...e.resources,coins:e.resources.coins+P,tomato:0,cucumber:0,corn:0,watermelon:0,apple:0,milk:0,egg:0,cheese:0,meat:0,feathers:0,wool:0}}}function Hs(e){return e.resources.coins<20?e:{...e,resources:{...e.resources,coins:e.resources.coins-20,feed:e.resources.feed+5}}}const fe=1;function Ys(e,r){const o=e.crops.find(p=>p.id===r);if(!o||!o.timer||M(o.timer))return e;const c=o.timer.durationMs-(Date.now()-o.timer.startedAt),d=Math.ceil(c/6e4),g=Math.max(1,d*fe);return e.resources.gems<g?e:{...e,resources:{...e.resources,gems:e.resources.gems-g},crops:e.crops.map(p=>p.id===r?{...p,timer:{...p.timer,startedAt:Date.now()-p.timer.durationMs}}:p)}}function Js(e,r){const o=e.animals.find(p=>p.id===r);if(!o||!o.timer||M(o.timer))return e;const c=o.timer.durationMs-(Date.now()-o.timer.startedAt),d=Math.ceil(c/6e4),g=Math.max(1,d*fe);return e.resources.gems<g?e:{...e,resources:{...e.resources,gems:e.resources.gems-g},animals:e.animals.map(p=>p.id===r?{...p,timer:{...p.timer,startedAt:Date.now()-p.timer.durationMs}}:p)}}function X(e){return e*50}function Ks(e,r){const o=e.crops.find(d=>d.id===r);if(!o)return e;const c=X(o.level);return e.resources.coins<c?e:{...e,resources:{...e.resources,coins:e.resources.coins-c},crops:e.crops.map(d=>d.id===r?{...d,level:d.level+1}:d)}}function Vs(e,r){const o=e.animals.find(d=>d.id===r);if(!o)return e;const c=X(o.level);return e.resources.coins<c?e:{...e,resources:{...e.resources,coins:e.resources.coins-c},animals:e.animals.map(d=>d.id===r?{...d,level:d.level+1}:d)}}function qe(e){if(!e)return 0;const r=e.durationMs-(Date.now()-e.startedAt);return r<=0?0:Math.max(1,Math.ceil(r/6e4)*fe)}function de(){var e;try{return((e=window.Telegram)==null?void 0:e.WebApp)??null}catch{return null}}function qs(){var e,r;try{if(typeof window>"u")return{userId:"DEMO_USER",isTelegram:!1};const o=(e=window.Telegram)==null?void 0:e.WebApp;if(o&&((r=o.initDataUnsafe)!=null&&r.user)){const c=o.initDataUnsafe.user;return{userId:String(c.id),username:c.username,isTelegram:!0,startParam:o.initDataUnsafe.start_param}}try{const d=new URLSearchParams(window.location.search).get("uid");if(d)return{userId:String(d),isTelegram:!0,startParam:void 0}}catch{}return{userId:"DEMO_USER",isTelegram:!1}}catch{return{userId:"DEMO_USER",isTelegram:!1}}}function Qs(){var r;const e=(r=window.Telegram)==null?void 0:r.WebApp;e&&typeof e.ready=="function"&&e.ready()}const A="https://open-farm-1.onrender.com";async function Qe(e){try{const r=await fetch(`${A}/api/me?userId=${encodeURIComponent(e)}`,{credentials:"include"});return r.ok?await r.json():null}catch{return null}}async function ue(e,r,o){try{const c=await fetch(`${A}/api/farm/sync`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e,state:r,username:o??void 0})});return c.ok?await c.json():null}catch{return null}}async function Xs(e,r){try{return(await fetch(`${A}/api/referral/bind`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e,referrerId:r})})).ok}catch{return!1}}async function Xe(e){try{const r=await fetch(`${A}/api/referral/stats?userId=${encodeURIComponent(e)}`,{credentials:"include"});if(!r.ok)return null;const o=await r.json();return{referredCount:o.referredCount??0,rewardsGems:o.rewardsGems??0}}catch{return null}}async function Zs(e){try{const r=await fetch(`${A}/api/daily/claim`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e})});return r.ok?await r.json():null}catch{return null}}const me=[{id:"gems_50",gems:50,stars:10,title:"50 –≥–µ–º–æ–≤",description:"50 –≥–µ–º–æ–≤ –∑–∞ 10 ‚≠ê"},{id:"gems_100",gems:100,stars:20,title:"100 –≥–µ–º–æ–≤",description:"100 –≥–µ–º–æ–≤ –∑–∞ 20 ‚≠ê"},{id:"gems_200",gems:200,stars:25,title:"200 –≥–µ–º–æ–≤",description:"200 –≥–µ–º–æ–≤ –∑–∞ 25 ‚≠ê"}];async function Ze(){try{const e=await fetch(`${A}/api/payments/packages`,{credentials:"include"});if(!e.ok)return me;const r=await e.json(),o=r==null?void 0:r.packages;if(Array.isArray(o)&&o.length>0&&o.every(c=>(c==null?void 0:c.id)&&typeof c.stars=="number"))return o}catch{}return me}async function et(e,r){try{const o=await fetch(`${A}/api/payments/create-invoice`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e,packageId:r})});return o.ok?await o.json():null}catch{return null}}async function st(e,r){try{const o=await fetch(`${A}/api/payments/create-custom-invoice`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e,gems:r})}),c=await o.json().catch(()=>null);return o.ok?c:c||{ok:!1,error:`HTTP ${o.status}`}}catch{return null}}async function O(e,r){try{const o=await fetch(`${A}/api/payments/confirm-paid`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e,...r})});return o.ok?await o.json():null}catch{return null}}async function tt(){try{const e=await fetch(`${A}/api/stats`,{credentials:"include"});return e.ok?await e.json():null}catch{return null}}async function nt(e,r,o,c){try{const d=await fetch(`${A}/api/admin/reward`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({adminId:e,targetUserId:r,resource:o,amount:c})});return d.ok?await d.json():null}catch{return null}}function rt(e){return`farm-miniapp-state-v1-${e}`}function it(e,r){if(r)try{window.localStorage.setItem(rt(r),JSON.stringify(e))}catch{}}function ot(e){const r=Math.max(0,Math.round(e/1e3)),o=Math.floor(r/60),c=r%60;return o===0?`${c}s`:`${o}m ${c.toString().padStart(2,"0")}s`}function at(e){if(!e)return 0;const r=Date.now()-e.startedAt;return Math.max(0,e.durationMs-r)}const es=({slot:e,kind:r,onAction:o,onBoost:c,onUpgrade:d,onGemUpgrade:g,canBoost:p,canUpgrade:x,canGemUpgrade:w,boostCost:y,upgradeCost:j,gemUpgradeLevel:N,maxGemUpgradeLevel:h})=>{const[P,D]=f.useState(!1),G=M(e.timer),K=e.timer?zs(e.timer):0,Z=e.timer?at(e.timer):0,W=r==="crop",ee=W?"–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤—Å–µ—Ö —Ä–∞—Å—Ç–µ–Ω–∏–π –Ω–∞ –≤—Ç–æ—Ä–æ–π —É—Ä–æ–≤–µ–Ω—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–æ–≤–æ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å –∑–∞ 30 –≥–µ–º–æ–≤.":"–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤—Å–µ—Ö —Ä–∞—Å—Ç–µ–Ω–∏–π –Ω–∞ –≤—Ç–æ—Ä–æ–π —É—Ä–æ–≤–µ–Ω—å –∏ –∂–∏–≤–æ—Ç–Ω—ã—Ö –Ω–∞ –ø–µ—Ä–≤—ã–π –∏ –≤—Ç–æ—Ä–æ–π —É—Ä–æ–≤–µ–Ω—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–æ–≤–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å –∑–∞ 30 –≥–µ–º–æ–≤.";let S="",T="",k="";if(W)switch(e.type){case"tomato":S="–ü–æ–º–∏–¥–æ—Ä—ã",T="üçÖ",k="—Ç–æ–º–∞—Ç—ã";break;case"cucumber":S="–û–≥—É—Ä—Ü—ã",T="ü•í",k="–æ–≥—É—Ä—Ü—ã";break;case"corn":S="–ö—É–∫—É—Ä—É–∑–∞",T="üåΩ",k="–∫—É–∫—É—Ä—É–∑–∞";break;case"watermelon":S="–ê—Ä–±—É–∑",T="üçâ",k="–∞—Ä–±—É–∑";break;case"apple":S="–Ø–±–ª–æ–∫–æ",T="üçé",k="—è–±–ª–æ–∫–∏";break;default:S="–ì—Ä—è–¥–∫–∞",T="üå±",k="—É—Ä–æ–∂–∞–π"}else switch(e.type){case"cow":S="–ö–æ—Ä–æ–≤–∞",T="üêÑ",k="–º–æ–ª–æ–∫–æ";break;case"chicken":S="–ö—É—Ä–∏—Ü–∞",T="üêî",k="—è–π—Ü–∞";break;case"goat":S="–ö–æ–∑–∞",T="üêê",k="—Å—ã—Ä";break;case"sheep":S="–û–≤—Ü–∞",T="üêë",k="—à–µ—Ä—Å—Ç—å";break;case"pig":S="–ü–æ—Ä–æ—Å—ë–Ω–æ–∫",T="üêñ",k="–º—è—Å–æ";break;case"goose":S="–ì—É—Å—å",T="ü¶¢",k="–ø–µ—Ä—å—è";break;default:S="–ñ–∏–≤–æ—Ç–Ω–æ–µ",T="üêæ",k="–ø—Ä–æ–¥—É–∫—Ü–∏—è"}const F=e.timer?G?"–°–æ–±—Ä–∞—Ç—å":"–ò–¥—ë—Ç —Ä–æ—Å—Ç":W?"–ü–æ—Å–∞–¥–∏—Ç—å":"–ü–æ–∫–æ—Ä–º–∏—Ç—å",H=e.timer&&!G&&y>0,B=e.harvestsSinceLevel??0;return t.jsx("div",{className:`tile ${W?"vegetable":"animal"}`,children:t.jsxs("div",{className:`tile-inner ${P?"is-flipped":""}`,children:[t.jsxs("div",{className:"tile-face tile-face-front",children:[t.jsxs("div",{className:"tile-header",children:[t.jsx("span",{className:"tile-name",children:S}),t.jsxs("span",{className:"tile-level",children:["–£—Ä. ",e.level]})]}),t.jsxs("div",{className:"tile-main",children:[t.jsx("span",{className:"tile-icon",children:T}),t.jsxs("div",{className:"tile-yield",children:[t.jsxs("div",{children:["–í—ã—Ö–æ–¥: √ó",e.baseYield*e.level," ",k]}),t.jsxs("div",{style:{fontSize:11,color:"#9ca3af"},children:["–î–æ —Å–ª–µ–¥. —É—Ä–æ–≤–Ω—è: ",B,"/5 —Å–±–æ—Ä–æ–≤"]}),e.timer&&t.jsxs("div",{className:"tile-timer",children:[G?"–ì–æ—Ç–æ–≤–æ –∫ —Å–±–æ—Ä—É":`–û—Å—Ç–∞–ª–æ—Å—å: ${ot(Z)}`,t.jsx("div",{className:"progress-bar",children:t.jsx("div",{className:"progress-fill",style:{width:`${K*100}%`}})})]}),!e.timer&&t.jsx("div",{className:"tile-timer",children:"–û–∂–∏–¥–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è"})]})]}),t.jsxs("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:[t.jsx("button",{className:"btn btn-secondary",type:"button",onClick:o,style:{flex:1},children:F}),H&&t.jsxs("button",{className:"btn btn-primary",type:"button",onClick:c,disabled:!p,style:{fontSize:10,padding:"6px 8px"},title:p?`–£—Å–∫–æ—Ä–∏—Ç—å –∑–∞ ${y} üíé`:"–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –≥–µ–º–æ–≤",children:["‚ö° ",y,"üíé"]})]}),t.jsxs("div",{style:{display:"flex",gap:4,marginTop:4},children:[h>0&&t.jsxs("button",{className:"btn btn-secondary",type:"button",onClick:g,disabled:!w||N>=h,style:{fontSize:10,opacity:w&&N<h?1:.5},children:["üíé –£—Ä.",N,"/",h," ‚Äî ",r==="crop"?20:e.type==="cow"?30:e.type==="chicken"?20:60," üíé"]}),h>0&&t.jsx("button",{type:"button",onClick:()=>D(!0),style:{fontSize:10,color:"#9ca3af",marginLeft:4,alignSelf:"center",width:20,height:20,minWidth:20,padding:0,borderRadius:"50%",border:"1px solid rgba(148,163,184,0.5)",background:"rgba(15,23,42,0.8)",cursor:"pointer",lineHeight:1,display:"inline-flex",alignItems:"center",justifyContent:"center"},title:"–ü–æ–¥—Å–∫–∞–∑–∫–∞",children:"?"})]})]}),t.jsxs("div",{className:"tile-face tile-face-back",children:[t.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",fontSize:11,color:"#e2e8f0",padding:"0 8px"},children:t.jsx("div",{children:ee})}),t.jsx("div",{style:{display:"flex",justifyContent:"flex-end",padding:"0 6px 6px"},children:t.jsx("button",{type:"button",onClick:()=>D(!1),style:{fontSize:10,color:"#9ca3af",width:22,height:22,minWidth:22,padding:0,borderRadius:"50%",border:"1px solid rgba(148,163,184,0.5)",background:"rgba(15,23,42,0.9)",cursor:"pointer",lineHeight:1,display:"inline-flex",alignItems:"center",justifyContent:"center"},title:"–ù–∞–∑–∞–¥",children:"‚Ü©"})})]})]})})},v="https://open-farm-1.onrender.com",Q="https://t.me/Youdic_Bot";function ct(){var e;try{if(typeof window>"u")return!1;const r=(e=window.Telegram)==null?void 0:e.WebApp;return(r==null?void 0:r.platform)==="ios"?!0:typeof navigator<"u"&&/iPhone|iPad|iPod/i.test(navigator.userAgent||"")}catch{return!1}}const dt=()=>{var Me,We,Be,ze,Oe,_e,Pe,De,Ge,Fe,He;const[e]=f.useState(()=>{try{return qs()}catch{return{userId:"DEMO_USER",isTelegram:!1}}}),[r,o]=f.useState(()=>J()),[c,d]=f.useState("fields"),[g]=f.useState(()=>{try{return new URLSearchParams(window.location.search).get("admin")==="1"}catch{return!1}}),[p,x]=f.useState(null),[w,y]=f.useState(null),[j,N]=f.useState(null),[h,P]=f.useState(null),[D,G]=f.useState(()=>me),[K,Z]=f.useState(""),[W,ee]=f.useState(""),[S,T]=f.useState("gems"),[k,F]=f.useState(null),H=f.useRef([]),B=f.useRef(r);f.useEffect(()=>{B.current=r},[r]);const L=f.useRef(!1),se=f.useRef(null),V=f.useCallback(()=>{e.userId&&(L.current||Qe(e.userId).then(s=>{try{if(L.current||!s||s.level===void 0)return;const n=J(),i=s.revision,u=Ve({...n,level:s.level,resources:s.resources!=null?s.resources:n.resources,crops:Array.isArray(s.crops)?s.crops:n.crops,animals:Array.isArray(s.animals)?s.animals:n.animals,revision:typeof i=="number"?i:n.revision,referrerId:s.referrerId??void 0,referrerUsername:s.referrerUsername??void 0});o(u)}catch{}}).catch(()=>{}))},[e.userId]),te=f.useCallback(()=>{if(!e.userId)return;const s=B.current;if(s)try{const n=JSON.stringify({userId:e.userId,state:s,username:e.username??void 0});navigator.sendBeacon(`${v}/api/farm/sync`,new Blob([n],{type:"application/json"}))}catch{}},[v,e.userId,e.username]);f.useEffect(()=>{const s=()=>te();window.addEventListener("pagehide",s),window.addEventListener("beforeunload",s);const n=()=>{document.visibilityState==="hidden"&&te()};return document.addEventListener("visibilitychange",n),()=>{window.removeEventListener("pagehide",s),window.removeEventListener("beforeunload",s),document.removeEventListener("visibilitychange",n)}},[te]),f.useEffect(()=>{if(!e.userId)return;const s=setInterval(()=>{if(L.current){const n=B.current;ue(e.userId,n,e.username).then(()=>{L.current=!1}).catch(()=>{})}},5e3);return()=>clearInterval(s)},[v,e.userId,e.username]);const pe=s=>`farm-miniapp-achievements-v1-${s}`,ts=s=>{try{const n=window.localStorage.getItem(pe(s));if(!n)return{plantHarvests:0,animalFeeds:0,rewardClaimed:!1};const i=JSON.parse(n);return{plantHarvests:i.plantHarvests??0,animalFeeds:i.animalFeeds??0,rewardClaimed:!!i.rewardClaimed}}catch{return{plantHarvests:0,animalFeeds:0,rewardClaimed:!1}}},[_,ne]=f.useState(()=>ts(e.userId)),he=s=>`farm-miniapp-weekly-v1-${s}`,ns=s=>{try{const n=window.localStorage.getItem(he(s));if(!n)return{harvestsThisWeek:0,coinsEarnedThisWeek:0};const i=JSON.parse(n);return{harvestsThisWeek:i.harvestsThisWeek??0,coinsEarnedThisWeek:i.coinsEarnedThisWeek??0}}catch{return{harvestsThisWeek:0,coinsEarnedThisWeek:0}}},[z,re]=f.useState(()=>ns(e.userId)),rs=(s,n)=>{if(n)try{window.localStorage.setItem(he(n),JSON.stringify(s))}catch{}},is=(s,n)=>{if(n)try{window.localStorage.setItem(pe(n),JSON.stringify(s))}catch{}};f.useEffect(()=>{is(_,e.userId)},[_,e.userId]),f.useEffect(()=>{rs(z,e.userId)},[z,e.userId]),f.useEffect(()=>{Ze().then(s=>s.length>0&&G(s)).catch(()=>{})},[]),f.useEffect(()=>{e.isTelegram&&c==="referrals"&&v&&e.userId&&Xe(e.userId).then(x),e.isTelegram&&c==="stats"&&v&&tt().then(y)},[c,e.userId,e.isTelegram,V]),f.useEffect(()=>{it(r,e.userId)},[r,e.userId]),f.useEffect(()=>{if(e.userId){V();return}},[e.userId,V]),f.useEffect(()=>{Qs();const s=e.startParam;if(e.isTelegram&&v&&s&&s.startsWith("ref_")&&e.userId){const i=s.slice(4);i&&Xs(e.userId,i)}e.isTelegram&&v&&e.userId&&(Xe(e.userId).then(x).catch(()=>{}),Ze().then(G).catch(()=>{}));const n=window.setInterval(()=>{o(i=>({...i}))},1e3);return()=>window.clearInterval(n)},[e.isTelegram,e.userId,V]),f.useEffect(()=>{e.userId==="DEMO_USER"&&window.location.replace(`${Q}?start=app`)},[e.userId]);const R=f.useCallback(()=>{if(!e.userId)return;const s=()=>{Qe(e.userId).then(n=>{try{if(L.current||!n||n.level===void 0)return;const i=J(),u=n.revision,m=Ve({...i,level:n.level,resources:n.resources!=null?n.resources:i.resources,crops:Array.isArray(n.crops)?n.crops:i.crops,animals:Array.isArray(n.animals)?n.animals:i.animals,revision:typeof u=="number"?u:i.revision,referrerId:n.referrerId??void 0,referrerUsername:n.referrerUsername??void 0});o(m)}catch{}}).catch(()=>{})};L.current?ue(e.userId,B.current,e.username).then(()=>{L.current=!1,s()}).catch(()=>s()):s()},[e.userId,e.username]),C=R;f.useEffect(()=>{c!=="shop"||!v||!e.userId||R()},[c,v,e.userId,R]),f.useEffect(()=>{if(c!=="shop"||!v||!e.userId)return;const s=setInterval(R,5e3);return()=>clearInterval(s)},[c,v,e.userId,R]),f.useEffect(()=>{if(!e.userId||!e.isTelegram)return;const s=()=>{R(),H.current.push(setTimeout(R,1e3)),H.current.push(setTimeout(R,3e3))};let n=document.visibilityState==="hidden";const i=()=>{n&&document.visibilityState==="visible"&&s(),n=document.visibilityState==="hidden"};return document.addEventListener("visibilitychange",i),window.addEventListener("focus",s),()=>{document.removeEventListener("visibilitychange",i),window.removeEventListener("focus",s),H.current.forEach(clearTimeout),H.current=[]}},[v,e.userId,e.isTelegram,R]),f.useEffect(()=>{const s=de();if(!(s!=null&&s.onEvent)||!v||!e.userId)return;const n=i=>{((i==null?void 0:i.status)==="paid"||(i==null?void 0:i.status)==="completed")&&R()};return s.onEvent("invoiceClosed",n),()=>{s.offEvent&&s.offEvent("invoiceClosed",n)}},[v,e.userId,R]);const I=f.useCallback(s=>{o(n=>{const i=n??J(),u=s(i),m=(i.revision??0)+1,l={...u,revision:m};return L.current=!0,B.current=l,l}),se.current&&clearTimeout(se.current),se.current=setTimeout(()=>{if(!e.userId||!L.current)return;const n=B.current;ue(e.userId,n,e.username).then(()=>{L.current=!1}).catch(()=>{})},50)},[e.userId,e.username]),os=s=>{I(n=>_s(n,s))},as=s=>{I(n=>Ps(n,s)),ne(n=>({...n,animalFeeds:n.animalFeeds+1}))},cs=s=>{I(n=>Ds(n,s)),ne(n=>({...n,plantHarvests:n.plantHarvests+1})),re(n=>({...n,harvestsThisWeek:n.harvestsThisWeek+1}))},ls=s=>{I(n=>Gs(n,s))},ds=()=>{I(s=>{var u;const n=Fs(s),i=n.resources.coins-(((u=s.resources)==null?void 0:u.coins)??0);return re(m=>({...m,coinsEarnedThisWeek:m.coinsEarnedThisWeek+i})),n})},us=()=>{I(s=>Hs(s))},ms=s=>{I(n=>Ys(n,s))},fs=s=>{I(n=>Js(n,s))},ps=s=>{I(n=>Ks(n,s))},hs=s=>{I(n=>Vs(n,s))},gs=async()=>{if(!e.userId){N("–ü–æ–¥–∫–ª—é—á–∏ backend (VITE_API_URL) –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –Ω–∞–≥—Ä–∞–¥—ã.");return}const s=await Zs(e.userId);if(!s){N("–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞.");return}if(P(s),s.claimed&&s.reward&&s.resources){const n=[];s.reward.coins&&n.push(`${s.reward.coins} –º–æ–Ω–µ—Ç`),s.reward.gems&&n.push(`${s.reward.gems} –≥–µ–º–æ–≤`),s.reward.feed&&n.push(`${s.reward.feed} –∫–æ—Ä–º–∞`),N(`–ù–∞–≥—Ä–∞–¥–∞: ${n.join(", ")}. –ú–∞—Ä–∞—Ñ–æ–Ω: –¥–µ–Ω—å ${s.streak??1} –∏–∑ 5.`),I(i=>({...i,resources:{...i.resources,...s.resources}}))}else if(!s.claimed){const n=s.nextAt?new Date(s.nextAt).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}):"";N(`–£–∂–µ –∑–∞–±—Ä–∞–ª —Å–µ–≥–æ–¥–Ω—è. –°–ª–µ–¥—É—é—â–∞—è –Ω–∞–≥—Ä–∞–¥–∞ –ø–æ—Å–ª–µ ${n}`)}},ys=(r.resources.coins??0).toLocaleString("ru-RU"),bs=(r.resources.gems??0).toLocaleString("ru-RU"),vs=(r.resources.feed??0).toLocaleString("ru-RU"),xs=r.crops.some(s=>M(s.timer)),ws=r.animals.some(s=>M(s.timer)),ge=`https://t.me/Youdic_Bot?start=ref_${e.userId}`,js=async()=>{try{await navigator.clipboard.writeText(ge)}catch{}},ye=(s,n)=>{const i=m=>n.crops.find(l=>l.id===m),u=m=>((m==null?void 0:m.gemUpgradeLevel)??0)>=2;return s==="corn"?u(i("c1"))&&u(i("c2"))&&u(i("c3")):s==="watermelon"?u(i("c4")):s==="apple"?u(i("c5")):!1},be=(s,n)=>{const i=a=>n.animals.find(b=>b.type===a),u=a=>n.crops.find(b=>b.id===a),m=a=>((a==null?void 0:a.gemUpgradeLevel)??0)>=2,l=a=>((a==null?void 0:a.gemUpgradeLevel)??0)>=2;if(s==="goat"){const a=i("cow"),b=i("chicken"),$=m(u("c1"))&&m(u("c2"))&&m(u("c3")),Y=((a==null?void 0:a.gemUpgradeLevel)??0)>=1&&((b==null?void 0:b.gemUpgradeLevel)??0)>=1;return $&&Y}return s==="sheep"?l(i("goat")):s==="pig"?l(i("sheep")):s==="goose"?l(i("pig")):!1},Ss=s=>{I(n=>{const i=n.crops.find(u=>u.id===s);return!i||i.unlocked||n.resources.gems<30||!ye(i.type,n)?n:{...n,resources:{...n.resources,gems:n.resources.gems-30},crops:n.crops.map(u=>u.id===s?{...u,unlocked:!0}:u)}})},ks=s=>{I(n=>{const i=n.animals.find(u=>u.id===s);return!i||i.unlocked||n.resources.gems<30||!be(i.type,n)?n:{...n,resources:{...n.resources,gems:n.resources.gems-30},animals:n.animals.map(u=>u.id===s?{...u,unlocked:!0}:u)}})},ve=s=>{switch(s){case"tomato":case"cucumber":case"corn":case"watermelon":case"apple":return 2;default:return 0}},xe=s=>{switch(s){case"cow":return 1;case"chicken":return 1;case"goat":case"sheep":case"pig":case"goose":return 2;default:return 0}},Is=s=>{I(n=>{const i=n.crops.map(m=>{if(m.id!==s)return m;const l=m.gemUpgradeLevel??0,a=ve(m.type);return l>=a||n.resources.gems<20?m:{...m,gemUpgradeLevel:l+1}});return n.crops!==i?{...n,resources:{...n.resources,gems:n.resources.gems-20},crops:i}:n})},Ts=s=>{I(n=>{const i=n.animals.map(a=>{if(a.id!==s)return a;const b=a.gemUpgradeLevel??0,$=xe(a.type);if(b>=$)return a;const Y=a.type==="cow"?30:a.type==="chicken"?20:60;return n.resources.gems<Y?a:{...a,gemUpgradeLevel:b+1}});if(!(n.animals!==i))return n;const m=i.find((a,b)=>a.gemUpgradeLevel!==(n.animals[b].gemUpgradeLevel??0));if(!m)return n;const l=m.type==="cow"?30:m.type==="chicken"?20:60;return{...n,resources:{...n.resources,gems:n.resources.gems-l},animals:i}})},Cs=()=>{o(s=>s.resources.gems<10?s:{...s,resources:{...s.resources,gems:s.resources.gems-10,coins:s.resources.coins+100}})},we=1e5,Ns=1e4,Ls=()=>{o(s=>(s.resources.coins??0)<we?s:{...s,resources:{...s.resources,coins:(s.resources.coins??0)-we,gems:(s.resources.gems??0)+Ns}})},[je,Se]=f.useState(null),[ke,Us]=f.useState(""),[Ie,Te]=f.useState(!1),[Ce,E]=f.useState(null),ie=s=>`farm-miniapp-custom-username-v1-${s}`,[oe,Rs]=f.useState(()=>{try{return window.localStorage.getItem(ie(e.userId))||""}catch{return""}}),[As,Ne]=f.useState(!1),[Le,Ue]=f.useState(""),q=f.useCallback(()=>{C(),setTimeout(C,1e3),setTimeout(C,2500),setTimeout(C,5e3),setTimeout(C,1e4),setTimeout(C,2e4)},[C]),$s=async s=>{if(!e.userId||!v){alert("–ü–æ–∫—É–ø–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ Telegram");return}Se(s);try{const n=await et(e.userId,s);if(!(n!=null&&n.invoiceLink)){alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç—ë–∂");return}const i=de(),u=()=>{try{q()}catch{C()}},m=()=>{E({packageId:s});const a=()=>{C(),setTimeout(C,400),q()};e.userId&&v?O(e.userId,{packageId:s}).then(b=>{if(b!=null&&b.ok){E(null),a();return}setTimeout(()=>O(e.userId,{packageId:s}).then($=>{$!=null&&$.ok&&E(null),a()}),1500)}).catch(()=>{setTimeout(()=>O(e.userId,{packageId:s}).then(b=>{b!=null&&b.ok&&E(null),a()}),1500)}):a()},l=a=>a==="paid"||a==="completed"||typeof a=="object"&&a!==null&&a.status==="paid";if(i!=null&&i.openInvoice){try{i.openInvoice(n.invoiceLink,a=>{const b=typeof a=="object"&&a!==null&&"status"in a?a.status:String(a);(l(b)||l(a))&&m()})}catch{}u()}else if(i!=null&&i.openTelegramLink){try{i.openTelegramLink(n.invoiceLink),i.platform==="ios"&&i.showAlert&&i.showAlert("–ï—Å–ª–∏ –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã –Ω–µ –æ—Ç–∫—Ä—ã–ª–æ—Å—å ‚Äî –Ω–∞–∂–º–∏—Ç–µ –≤–Ω–∏–∑—É ¬´–û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã¬ª, –∑–∞—Ç–µ–º –≤ —á–∞—Ç–µ –≤–≤–µ–¥–∏—Ç–µ /donate –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø–∞–∫–µ—Ç.")}catch{}u()}else window.open(n.invoiceLink,"_blank"),u()}catch{alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–∞")}finally{Se(null)}},U=Number(ke.replace(/\D/g,"")),Re=U>0?Math.max(1,Math.ceil(U/5)):0,Es=async()=>{if(!e.userId||!v){alert("–ü–æ–∫—É–ø–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ Telegram");return}if(!(!U||U<=0)){Te(!0);try{const s=await st(e.userId,U);if(!(s!=null&&s.invoiceLink)){const l=(s==null?void 0:s.error)||"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç—ë–∂";alert(l);return}const n=de(),i=()=>{try{q()}catch{C()}},u=()=>{E({gems:U});const l=()=>{C(),setTimeout(C,400),q()};e.userId&&v?O(e.userId,{gems:U}).then(a=>{if(a!=null&&a.ok){E(null),l();return}setTimeout(()=>O(e.userId,{gems:U}).then(b=>{b!=null&&b.ok&&E(null),l()}),1500)}).catch(()=>{setTimeout(()=>O(e.userId,{gems:U}).then(a=>{a!=null&&a.ok&&E(null),l()}),1500)}):l()},m=l=>l==="paid"||l==="completed"||typeof l=="object"&&l!==null&&l.status==="paid";if(n!=null&&n.openInvoice){try{n.openInvoice(s.invoiceLink,l=>{const a=typeof l=="object"&&l!==null&&"status"in l?l.status:String(l);(m(a)||m(l))&&u()})}catch{}i()}else if(n!=null&&n.openTelegramLink){try{n.openTelegramLink(s.invoiceLink),n.platform==="ios"&&n.showAlert&&n.showAlert("–ï—Å–ª–∏ –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã –Ω–µ –æ—Ç–∫—Ä—ã–ª–æ—Å—å ‚Äî –Ω–∞–∂–º–∏—Ç–µ –≤–Ω–∏–∑—É ¬´–û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã¬ª, –∑–∞—Ç–µ–º –≤ —á–∞—Ç–µ –≤–≤–µ–¥–∏—Ç–µ /donate –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ—é —Å—É–º–º—É.")}catch{}i()}else window.open(s.invoiceLink,"_blank"),i()}catch{alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–∞")}finally{Te(!1)}}},Ae=_.plantHarvests>=10&&_.animalFeeds>=5&&!_.rewardClaimed,ae=100,ce=1e3,$e=200,Ee=z.harvestsThisWeek>=ae&&z.coinsEarnedThisWeek>=ce,Ms=()=>{if(!Ee)return;I(n=>({...n,resources:{...n.resources,coins:(n.resources.coins??0)+$e}})),re({harvestsThisWeek:0,coinsEarnedThisWeek:0})},Ws=()=>{if(!Ae)return;const s=100;I(n=>({...n,resources:{...n.resources,coins:(n.resources.coins??0)+s}})),ne(n=>({...n,rewardClaimed:!0}))};return e.userId==="DEMO_USER"?t.jsx("div",{className:"app-root",children:t.jsx("div",{className:"card",style:{padding:24,textAlign:"center"},children:t.jsx("div",{style:{fontSize:18},children:"–û—Ç–∫—Ä—ã–≤–∞–µ–º‚Ä¶"})})}):t.jsx("div",{className:"app-root",children:t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsxs("div",{children:[t.jsx("div",{className:"title",children:"–¢–æ–º–∞—Ç–Ω–∞—è —Ñ–µ—Ä–º–∞"}),t.jsxs("div",{className:"subtitle",children:[e.username?`@${e.username}`:"–ú–∏–Ω–∏‚Äë–∞–ø–ø"," ¬∑ –£—Ä. ",r.level]})]}),t.jsx("div",{style:{fontSize:18},children:"üöú"})]}),t.jsxs("div",{className:"resources",children:[t.jsxs("div",{className:"pill",children:[t.jsx("span",{className:"pill-label",children:"–ú–æ–Ω–µ—Ç—ã"}),t.jsxs("span",{className:"pill-value",children:["ü™ô ",ys]})]}),t.jsxs("div",{className:"pill secondary",children:[t.jsx("span",{className:"pill-label",children:"–ì–µ–º—ã"}),t.jsxs("span",{className:"pill-value",children:["üíé ",bs]})]}),t.jsxs("div",{className:"pill secondary",children:[t.jsx("span",{className:"pill-label",children:"–ö–æ—Ä–º"}),t.jsxs("span",{className:"pill-value",children:["ü•£ ",vs]})]})]}),t.jsxs("div",{className:"tabs",children:[t.jsx("button",{type:"button",className:`tab ${c==="fields"?"active":""}`,onClick:()=>d("fields"),children:"–ì—Ä—è–¥–∫–∏"}),t.jsx("button",{type:"button",className:`tab ${c==="animals"?"active":""}`,onClick:()=>d("animals"),children:"–ñ–∏–≤–æ—Ç–Ω—ã–µ"}),t.jsx("button",{type:"button",className:`tab ${c==="market"?"active":""}`,onClick:()=>d("market"),children:"–†—ã–Ω–æ–∫"}),t.jsx("button",{type:"button",className:`tab ${c==="referrals"?"active":""}`,onClick:()=>d("referrals"),children:"–†–µ—Ñ–µ—Ä–∞–ª—ã"}),t.jsx("button",{type:"button",className:`tab ${c==="shop"?"active":""}`,onClick:()=>d("shop"),children:"–ú–∞–≥–∞–∑–∏–Ω"}),t.jsx("button",{type:"button",className:`tab ${c==="stats"?"active":""}`,onClick:()=>d("stats"),children:"üìä"})]}),t.jsxs("div",{className:"card-content",children:[c==="fields"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"section-title-row",children:[t.jsx("div",{className:"section-title",children:"–ì—Ä—è–¥–∫–∏"}),t.jsx("div",{className:"section-caption",children:"–¢—Ä–∞—Ç—å –º–æ–Ω–µ—Ç—ã, —á—Ç–æ–±—ã –ø–æ—Å–∞–¥–∏—Ç—å, –∏ —Å–æ–±–∏—Ä–∞–π —É—Ä–æ–∂–∞–π"})]}),t.jsx("div",{className:"grid",children:(r.crops??[]).map(s=>{if(s.unlocked===!1){const l=ye(s.type,r),a={tomato:"–ü–æ–º–∏–¥–æ—Ä—ã",cucumber:"–û–≥—É—Ä—Ü—ã",corn:"–ö—É–∫—É—Ä—É–∑–∞",watermelon:"–ê—Ä–±—É–∑",apple:"–Ø–±–ª–æ–∫–æ"};return t.jsxs("div",{className:"tile vegetable",style:{opacity:.7,display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[t.jsxs("div",{className:"tile-header",children:[t.jsx("span",{className:"tile-name",children:a[s.type]}),t.jsx("span",{className:"tile-level",children:"üîí"})]}),t.jsxs("div",{className:"tile-main",children:[t.jsx("span",{className:"tile-icon",children:"üå±"}),t.jsxs("div",{className:"tile-yield",children:[t.jsx("div",{style:{fontSize:10,color:"#9ca3af"},children:"–û—Ç–∫—Ä–æ–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —É—Å–ª–æ–≤–∏–π"}),t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Ss(s.id),disabled:!l||r.resources.gems<30,style:{marginTop:4,fontSize:10},children:"–û—Ç–∫—Ä—ã—Ç—å –∑–∞ 30 üíé"})]})]})]},s.id)}const n=qe(s.timer),i=X(s.level),u=s.gemUpgradeLevel??0,m=ve(s.type);return t.jsx(es,{slot:s,kind:"crop",onAction:()=>{s.timer?M(s.timer)&&cs(s.id):os(s.id)},onBoost:()=>ms(s.id),onUpgrade:()=>ps(s.id),onGemUpgrade:()=>Is(s.id),canBoost:r.resources.gems>=n&&n>0,canUpgrade:r.resources.coins>=i,canGemUpgrade:r.resources.gems>=20&&u<m,boostCost:n,upgradeCost:i,gemUpgradeLevel:u,maxGemUpgradeLevel:m},s.id)})})]}),c==="animals"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"section-title-row",children:[t.jsx("div",{className:"section-title",children:"–ñ–∏–≤–æ—Ç–Ω—ã–µ"}),t.jsx("div",{className:"section-caption",children:"–¢—Ä–∞—Ç—å –∫–æ—Ä–º, —á—Ç–æ–±—ã –æ–Ω–∏ –ø—Ä–∏–Ω–æ—Å–∏–ª–∏ –º–æ–ª–æ–∫–æ –∏ —è–π—Ü–∞"})]}),t.jsx("div",{className:"grid",children:(r.animals??[]).map(s=>{if(s.unlocked===!1){const l=be(s.type,r),a={cow:"–ö–æ—Ä–æ–≤–∞",chicken:"–ö—É—Ä–∏—Ü–∞",goat:"–ö–æ–∑–∞",sheep:"–û–≤—Ü–∞",pig:"–ü–æ—Ä–æ—Å—ë–Ω–æ–∫",goose:"–ì—É—Å—å"};return t.jsxs("div",{className:"tile animal",style:{opacity:.7,display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[t.jsxs("div",{className:"tile-header",children:[t.jsx("span",{className:"tile-name",children:a[s.type]}),t.jsx("span",{className:"tile-level",children:"üîí"})]}),t.jsxs("div",{className:"tile-main",children:[t.jsx("span",{className:"tile-icon",children:"üêæ"}),t.jsxs("div",{className:"tile-yield",children:[t.jsx("div",{style:{fontSize:10,color:"#9ca3af"},children:"–û—Ç–∫—Ä–æ–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —É—Å–ª–æ–≤–∏–π"}),t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>ks(s.id),disabled:!l||r.resources.gems<30,style:{marginTop:4,fontSize:10},children:"–û—Ç–∫—Ä—ã—Ç—å –∑–∞ 30 üíé"})]})]})]},s.id)}const n=qe(s.timer),i=X(s.level),u=s.gemUpgradeLevel??0,m=xe(s.type);return t.jsx(es,{slot:s,kind:"animal",onAction:()=>{s.timer?M(s.timer)&&ls(s.id):as(s.id)},onBoost:()=>fs(s.id),onUpgrade:()=>hs(s.id),onGemUpgrade:()=>Ts(s.id),canBoost:r.resources.gems>=n&&n>0,canUpgrade:r.resources.coins>=i,canGemUpgrade:r.resources.gems>=(s.type==="cow"?30:s.type==="chicken"?20:60)&&u<m,boostCost:n,upgradeCost:i,gemUpgradeLevel:u,maxGemUpgradeLevel:m},s.id)})})]}),c==="market"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"section-title-row",children:[t.jsx("div",{className:"section-title",children:"–†—ã–Ω–æ–∫ –∏ –ª–∞–≤–∫–∞"}),t.jsx("div",{className:"section-caption",children:"–ü—Ä–æ–¥–∞–≤–∞–π –ø—Ä–æ–¥—É–∫—Ü–∏—é –∏ –ø–æ–∫—É–ø–∞–π –∫–æ—Ä–º, –∑–∞–±–∏—Ä–∞–π –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –±–æ–Ω—É—Å—ã."})]}),t.jsxs("div",{style:{fontSize:12,marginBottom:8,color:"#9ca3af"},children:["–£—Ä–æ–∂–∞–π:"," ","üçÖ ",(((Me=r.resources)==null?void 0:Me.tomato)??0).toLocaleString("ru-RU")," ¬∑ ","ü•í ",(((We=r.resources)==null?void 0:We.cucumber)??0).toLocaleString("ru-RU")," ¬∑ ","ü•õ ",(((Be=r.resources)==null?void 0:Be.milk)??0).toLocaleString("ru-RU")," ¬∑ ","ü•ö ",(((ze=r.resources)==null?void 0:ze.egg)??0).toLocaleString("ru-RU")," ¬∑ ","üåΩ ",(((Oe=r.resources)==null?void 0:Oe.corn)??0).toLocaleString("ru-RU")," ¬∑ ","üçâ ",(((_e=r.resources)==null?void 0:_e.watermelon)??0).toLocaleString("ru-RU")," ¬∑ ","üçé ",(((Pe=r.resources)==null?void 0:Pe.apple)??0).toLocaleString("ru-RU")," ¬∑ ","üßÄ ",(((De=r.resources)==null?void 0:De.cheese)??0).toLocaleString("ru-RU")," ¬∑ ","ü•© ",(((Ge=r.resources)==null?void 0:Ge.meat)??0).toLocaleString("ru-RU")," ¬∑ ","ü™∂ ",(((Fe=r.resources)==null?void 0:Fe.feathers)??0).toLocaleString("ru-RU")," ¬∑ ","üß∂ ",(((He=r.resources)==null?void 0:He.wool)??0).toLocaleString("ru-RU")]}),t.jsxs(t.Fragment,{children:[t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:gs,style:{marginBottom:6},children:"üéÅ –ó–∞–±—Ä–∞—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é –Ω–∞–≥—Ä–∞–¥—É"}),j&&t.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4},children:j}),(h==null?void 0:h.streak)&&t.jsxs("div",{style:{fontSize:10,color:"#6b7280",marginBottom:6},children:["–ú–∞—Ä–∞—Ñ–æ–Ω: –¥–µ–Ω—å ",h.streak," –∏–∑ 5 (–¥–µ–Ω—å 1: 20ü™ô+5ü•£, 2: 30+5, 3: 40+5, 4: 50+5, 5: 100üíé+20ü•£)"]})]}),t.jsx("button",{type:"button",className:"btn btn-primary",onClick:ds,children:"–ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë –Ω–∞ —Ä—ã–Ω–∫–µ"}),t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:us,style:{marginTop:6},children:"–ö—É–ø–∏—Ç—å –∫–æ—Ä–º (5 —à—Ç. –∑–∞ 20 –º–æ–Ω–µ—Ç)"}),t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:Cs,style:{marginTop:6},disabled:(r.resources.gems??0)<10,children:"–û–±–º–µ–Ω—è—Ç—å 10 üíé –Ω–∞ 100 ü™ô"}),t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:Ls,style:{marginTop:6},disabled:(r.resources.coins??0)<1e5,children:"–û–±–º–µ–Ω—è—Ç—å 100‚ÄØ000 ü™ô –Ω–∞ 10‚ÄØ000 üíé"})]}),c==="referrals"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"section-title-row",children:[t.jsx("div",{className:"section-title",children:"–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞"}),t.jsx("div",{className:"section-caption",children:"–î–µ–ª–∏—Å—å —Å—Å—ã–ª–∫–æ–π –∏ –ø–æ–ª—É—á–∞–π –≥–µ–º—ã –∑–∞ –¥—Ä—É–∑–µ–π."})]}),p!==null&&t.jsxs("div",{style:{fontSize:12,color:"#e5e7eb",marginBottom:8,display:"flex",gap:12},children:[t.jsxs("span",{children:["–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ: ",t.jsx("strong",{children:p.referredCount})]}),t.jsxs("span",{children:["–ù–∞–≥—Ä–∞–¥–∞: ",t.jsxs("strong",{children:[p.rewardsGems," üíé"]})]})]}),t.jsxs("div",{style:{fontSize:12,color:"#9ca3af",marginBottom:8,display:"flex",alignItems:"center",gap:6,flexWrap:"wrap"},children:[t.jsx("span",{children:"–¢–≤–æ–π —é–∑–µ—Ä–Ω–µ–π–º:"}),As?t.jsxs(t.Fragment,{children:[t.jsx("input",{type:"text",value:Le,onChange:s=>Ue(s.target.value),placeholder:"–í–≤–µ–¥–∏ —é–∑–µ—Ä–Ω–µ–π–º",style:{flex:1,minWidth:120,padding:"6px 10px",borderRadius:8,border:"1px solid rgba(148,163,184,0.5)",background:"rgba(15,23,42,0.9)",color:"#e5e7eb",fontSize:12},autoFocus:!0}),t.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>{const s=Le.trim();try{s?window.localStorage.setItem(ie(e.userId),s):window.localStorage.removeItem(ie(e.userId))}catch{}Rs(s),Ne(!1)},style:{fontSize:12,padding:"6px 12px"},children:"OK"})]}):t.jsxs(t.Fragment,{children:[t.jsx("strong",{style:{color:"#e5e7eb"},children:oe?`@${oe.replace(/^@/,"")}`:e.username?`@${e.username}`:"‚Äî"}),t.jsx("button",{type:"button",onClick:()=>{Ue(oe||e.username||""),Ne(!0)},title:"–ò–∑–º–µ–Ω–∏—Ç—å —é–∑–µ—Ä–Ω–µ–π–º",style:{width:28,height:28,borderRadius:"50%",border:"1px solid rgba(148,163,184,0.5)",background:"rgba(30,41,59,0.8)",color:"#94a3b8",fontSize:14,display:"inline-flex",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:0},children:"‚úèÔ∏è"})]})]}),r.referrerId&&t.jsxs("div",{style:{fontSize:12,color:"#9ca3af",marginBottom:8},children:["–í–∞—Å –ø—Ä–∏–≥–ª–∞—Å–∏–ª: ",t.jsx("strong",{style:{color:"#e5e7eb"},children:r.referrerUsername?`@${r.referrerUsername}`:"–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"})]}),g&&t.jsxs("div",{style:{marginTop:12,padding:8,borderRadius:8,border:"1px dashed rgba(148,163,184,0.6)",background:"rgba(15,23,42,0.8)"},children:[t.jsx("div",{style:{fontSize:11,color:"#f97316",marginBottom:4},children:"–ê–¥–º–∏–Ω: —Ä–∞–∑–æ–≤–∞—è –Ω–∞–≥—Ä–∞–¥–∞ –∏–≥—Ä–æ–∫—É"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[t.jsx("input",{type:"text",placeholder:"ID –∏–≥—Ä–æ–∫–∞ (userId)",value:K,onChange:s=>Z(s.target.value),style:{padding:"6px 8px",borderRadius:6,border:"1px solid rgba(148,163,184,0.6)",fontSize:12,background:"rgba(15,23,42,0.9)",color:"#e5e7eb"}}),t.jsxs("div",{style:{display:"flex",gap:6},children:[t.jsx("input",{type:"number",min:1,placeholder:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ",value:W,onChange:s=>ee(s.target.value),style:{flex:1,padding:"6px 8px",borderRadius:6,border:"1px solid rgba(148,163,184,0.6)",fontSize:12,background:"rgba(15,23,42,0.9)",color:"#e5e7eb"}}),t.jsxs("select",{value:S,onChange:s=>T(s.target.value),style:{padding:"6px 8px",borderRadius:6,border:"1px solid rgba(148,163,184,0.6)",fontSize:12,background:"rgba(15,23,42,0.9)",color:"#e5e7eb"},children:[t.jsx("option",{value:"gems",children:"üíé –ì–µ–º—ã"}),t.jsx("option",{value:"coins",children:"ü™ô –ú–æ–Ω–µ—Ç—ã"})]})]}),t.jsxs("button",{type:"button",className:"btn btn-secondary",style:{fontSize:12,padding:"6px 10px"},onClick:async()=>{const s=Math.floor(Number(W||"0"));if(!K.trim()||!s||s<=0){F("–£–∫–∞–∂–∏ ID –∏–≥—Ä–æ–∫–∞ –∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ.");return}F("–û—Ç–ø—Ä–∞–≤–ª—è—é –Ω–∞–≥—Ä–∞–¥—É‚Ä¶");const n=await nt(e.userId,K.trim(),S,s);n!=null&&n.ok?F("–ù–∞–≥—Ä–∞–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞."):F("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –Ω–∞–≥—Ä–∞–¥—ã.")},children:["–ù–∞—á–∏—Å–ª–∏—Ç—å ",W||"?"," ",S==="gems"?"üíé":"ü™ô"]}),k&&t.jsx("div",{style:{fontSize:10,color:"#9ca3af"},children:k})]})]}),t.jsxs("div",{style:{fontSize:11,background:"rgba(15,23,42,0.9)",borderRadius:12,padding:8,border:"1px solid rgba(148,163,184,0.4)",wordBreak:"break-all"},children:[t.jsx("div",{style:{marginBottom:4},children:"–¢–≤–æ—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞:"}),t.jsxs("div",{style:{marginBottom:6},children:["https://t.me/Youdic_Bot?start=ref_",e.userId]}),t.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:js,style:{flex:1,minWidth:120},children:"–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É"}),t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{const s=encodeURIComponent("–ó–∞—Ö–æ–¥–∏ –≤ –º–æ—é —Ç–æ–º–∞—Ç–Ω—É—é —Ñ–µ—Ä–º—É –∏ –ø–æ–ª—É—á–∏ –±–æ–Ω—É—Å:"),i=`https://t.me/share/url?url=${encodeURIComponent(ge)}&text=${s}`;window.open(i,"_blank")},style:{flex:1,minWidth:120},children:"–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥—Ä—É–≥—É"})]})]}),t.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginTop:10},children:"–ó–∞ –ø–µ—Ä–≤—ã—Ö —Ç—Ä—ë—Ö –¥—Ä—É–∑–µ–π —Ç—ã –ø–æ–ª—É—á–∞–µ—à—å –ø–æ 10 üíé, –∞ –∫–æ–≥–¥–∞ –ø—Ä–∏–≥–ª–∞—Å–∏—à—å 5 ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ 25 üíé."})]}),c==="shop"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"section-title-row",children:[t.jsx("div",{className:"section-title",children:"–ú–∞–≥–∞–∑–∏–Ω"}),t.jsx("div",{className:"section-caption",children:"–ü–æ–∫—É–ø–∞–π –≥–µ–º—ã –∑–∞ Telegram Stars ‚≠ê"})]}),e.isTelegram&&!v,Ce&&v&&e.userId&&t.jsxs("div",{style:{padding:10,marginBottom:10,borderRadius:10,background:"rgba(34,197,94,0.15)",border:"1px solid rgba(34,197,94,0.5)",fontSize:12},children:[t.jsx("div",{style:{marginBottom:6},children:"–û–ø–ª–∞—Ç–∏–ª–∏, –Ω–æ –≥–µ–º—ã –Ω–µ –ø—Ä–∏—à–ª–∏? –ù–∞–∂–º–∏—Ç–µ ‚Äî –Ω–∞—á–∏—Å–ª–∏–º –ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–∫—É–ø–∫–µ:"}),t.jsx("button",{type:"button",className:"btn btn-primary",onClick:async()=>{var i,u,m,l;const s=Ce;if(!s)return;const n="packageId"in s?await O(e.userId,{packageId:s.packageId}):await O(e.userId,{gems:s.gems});n!=null&&n.ok?(E(null),C(),setTimeout(C,400),typeof((u=(i=window.Telegram)==null?void 0:i.WebApp)==null?void 0:u.showAlert)=="function"?window.Telegram.WebApp.showAlert("–ì–µ–º—ã –Ω–∞—á–∏—Å–ª–µ–Ω—ã. –ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª—ë–Ω."):alert("–ì–µ–º—ã –Ω–∞—á–∏—Å–ª–µ–Ω—ã.")):typeof((l=(m=window.Telegram)==null?void 0:m.WebApp)==null?void 0:l.showAlert)=="function"?window.Telegram.WebApp.showAlert("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞—á–∏—Å–ª–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑."):alert("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞—á–∏—Å–ª–∏—Ç—å.")},style:{fontSize:12},children:"–Ø –æ–ø–ª–∞—Ç–∏–ª ‚Äî –Ω–∞—á–∏—Å–ª–∏—Ç—å –≥–µ–º—ã"})]}),g&&v&&e.userId&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{marginBottom:8},children:t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:async()=>{var u;const s=m=>{var l,a;typeof((a=(l=window.Telegram)==null?void 0:l.WebApp)==null?void 0:a.showAlert)=="function"?window.Telegram.WebApp.showAlert(m):alert(m)},n=r.resources.gems??0;let i=`–û–ü–õ–ê–¢–ê
userId: ${e.userId}
API: ${v}
UI gems: ${n}
`;try{const m=await fetch(`${v}/health`,{credentials:"include"});if(i+=`health: ${m.status}
`,!m.ok){s(i);return}const l=await fetch(`${v}/api/me?userId=${encodeURIComponent(e.userId)}`,{credentials:"include"});if(i+=`api/me: ${l.status}
`,!l.ok){s(i);return}const a=await l.json(),b=((u=a==null?void 0:a.resources)==null?void 0:u.gems)??0;i+=`server gems: ${b}
`,s(i)}catch(m){i+=`error: ${(m==null?void 0:m.message)||String(m)}`,s(i)}},style:{fontSize:12,marginBottom:4},children:"–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ–ø–ª–∞—Ç—ã (admin)"})}),t.jsx("div",{style:{marginBottom:8},children:t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:async()=>{const s=u=>{var m,l;typeof((l=(m=window.Telegram)==null?void 0:m.WebApp)==null?void 0:l.showAlert)=="function"?window.Telegram.WebApp.showAlert(u):alert(u)},n=r.resources;let i=`–ü–†–û–ì–†–ï–°–° (–º–æ–Ω–µ—Ç—ã/—É—Ä–æ–∂–∞–π)
userId: ${e.userId}
API: ${v}
`;i+=`UI coins: ${n.coins??0}
`,i+=`UI tomato: ${n.tomato??0}, cucumber: ${n.cucumber??0}, corn: ${n.corn??0}, watermelon: ${n.watermelon??0}, apple: ${n.apple??0}
`,i+=`UI milk: ${n.milk??0}, egg: ${n.egg??0}, cheese: ${n.cheese??0}, meat: ${n.meat??0}, feathers: ${n.feathers??0}, wool: ${n.wool??0}
`;try{const u=await fetch(`${v}/api/farm/sync`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e.userId,state:r,username:e.username??void 0})});i+=`sync status: ${u.status}
`;const m=await fetch(`${v}/api/me?userId=${encodeURIComponent(e.userId)}`,{credentials:"include"});if(i+=`api/me: ${m.status}
`,!m.ok){s(i);return}const l=await m.json(),a=(l==null?void 0:l.resources)||{};i+=`SERVER coins: ${a.coins??0}
`;const b=["tomato","cucumber","corn","watermelon","apple","milk","egg","cheese","meat","feathers","wool"];let $=!1;for(const le of b){const Je=n[le]??0,Ke=a[le]??0;Je!==Ke&&($=!0,i+=`MISMATCH ${le}: ui=${Je}, server=${Ke}
`)}const Y=JSON.stringify(r.crops)===JSON.stringify((l==null?void 0:l.crops)??[]),Ye=JSON.stringify(r.animals)===JSON.stringify((l==null?void 0:l.animals)??[]);i+=`crops equal: ${Y}
`,i+=`animals equal: ${Ye}
`,$||!Y||!Ye?i+=`‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç UI ‚Äî –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.
`:i+=`–†–µ—Å—É—Ä—Å—ã –∏ —Å–ª–æ—Ç—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç ‚Äî –ø—Ä–æ–±–ª–µ–º–∞, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ UI.
`,s(i)}catch(u){i+=`error: ${(u==null?void 0:u.message)||String(u)}`,s(i)}},style:{fontSize:12},children:"–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (admin)"})})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[D.map(s=>t.jsxs("div",{style:{padding:10,borderRadius:14,background:"radial-gradient(circle at top, #166534 0, #020617 60%)",border:"1px solid rgba(34,197,94,0.6)",fontSize:12},children:[t.jsx("div",{style:{fontWeight:600,marginBottom:4},children:s.title}),t.jsxs("div",{style:{marginBottom:6,color:"#9ca3af"},children:["+",s.gems," üíé –∑–∞ ",s.stars," ‚≠ê"]}),t.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>$s(s.id),disabled:je===s.id,children:je===s.id?"–ó–∞–≥—Ä—É–∑–∫–∞...":`–ö—É–ø–∏—Ç—å –∑–∞ ${s.stars} ‚≠ê`})]},s.id)),t.jsxs("div",{style:{padding:10,borderRadius:14,background:"radial-gradient(circle at top, #0f172a 0, #020617 60%)",border:"1px solid rgba(148,163,184,0.5)",fontSize:12,color:"#e5e7eb"},children:[t.jsx("div",{style:{marginBottom:6,fontWeight:600},children:"–°–≤–æ—è —Å—É–º–º–∞"}),t.jsx("div",{style:{marginBottom:6,fontSize:11,color:"#9ca3af"},children:"–í–≤–µ–¥–∏, —Å–∫–æ–ª—å–∫–æ –≥–µ–º–æ–≤ —Ö–æ—á–µ—à—å –∫—É–ø–∏—Ç—å. –ö—É—Ä—Å: 1 ‚≠ê = 5 üíé."}),t.jsxs("div",{style:{display:"flex",gap:8,marginBottom:6},children:[t.jsx("input",{type:"number",min:1,value:ke,onChange:s=>Us(s.target.value),placeholder:"–ù–∞–ø—Ä–∏–º–µ—Ä, 80",style:{flex:1,borderRadius:999,border:"1px solid rgba(148,163,184,0.6)",background:"rgba(15,23,42,0.9)",color:"#e5e7eb",padding:"6px 10px",fontSize:12}}),t.jsxs("div",{style:{alignSelf:"center",fontSize:11,color:"#9ca3af"},children:["‚âà ",Re||0," ‚≠ê"]})]}),t.jsx("button",{type:"button",className:"btn btn-primary",disabled:!U||Ie,onClick:Es,children:Ie?"–ó–∞–≥—Ä—É–∑–∫–∞...":U?`–ö—É–ø–∏—Ç—å ${U} üíé –∑–∞ ${Re} ‚≠ê`:"–í–≤–µ–¥–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–µ–º–æ–≤"})]}),ct()&&t.jsxs("div",{style:{padding:10,borderRadius:14,background:"rgba(59,130,246,0.15)",border:"1px solid rgba(59,130,246,0.5)",fontSize:12,color:"#e5e7eb"},children:[t.jsxs("div",{style:{marginBottom:8},children:["–ù–∞ iPhone –æ–ø–ª–∞—Ç–∞ –∏–∑ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º–æ–∂–µ—Ç –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —á–∞—Ç —Å –±–æ—Ç–æ–º (–º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–∫—Ä–æ–µ—Ç—Å—è). –í —á–∞—Ç–µ –≤–≤–µ–¥–∏—Ç–µ ",t.jsx("strong",{children:"/donate"})," –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø–∞–∫–µ—Ç –∏–ª–∏ ¬´–°–≤–æ—è —Å—É–º–º–∞¬ª."]}),t.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>{var n;const s=(n=window.Telegram)==null?void 0:n.WebApp;s!=null&&s.openTelegramLink?(s.openTelegramLink(Q),setTimeout(()=>{var i;return(i=s==null?void 0:s.close)==null?void 0:i.call(s)},400)):s!=null&&s.openLink?(s.openLink(Q),setTimeout(()=>{var i;return(i=s==null?void 0:s.close)==null?void 0:i.call(s)},400)):window.location.href=Q},children:"–û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã"})]})]})]}),c==="stats"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"section-title-row",children:[t.jsx("div",{className:"section-title",children:"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"}),t.jsx("div",{className:"section-caption",children:"–¢–≤–æ—è —Ñ–µ—Ä–º–∞ –∏ —Ü–µ–ª–∏"})]}),t.jsxs("div",{style:{padding:12,borderRadius:14,background:"rgba(15,23,42,0.9)",border:"1px solid rgba(148,163,184,0.4)",fontSize:13,marginBottom:10},children:[t.jsx("div",{style:{marginBottom:8,fontWeight:600},children:"–¢–≤–æ—è —Ñ–µ—Ä–º–∞"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[t.jsxs("div",{children:[t.jsxs("div",{style:{color:"#9ca3af",fontSize:11},children:["–°–æ–±—Ä–∞–Ω–æ —É—Ä–æ–∂–∞—è –∑–∞ –Ω–µ–¥–µ–ª—é (—Ü–µ–ª—å ",ae,")"]}),t.jsx("div",{style:{fontSize:16,fontWeight:600},children:z.harvestsThisWeek.toLocaleString("ru-RU")}),t.jsx("div",{className:"progress-bar",children:t.jsx("div",{className:"progress-fill",style:{width:`${Math.min(1,z.harvestsThisWeek/ae)*100}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{style:{color:"#9ca3af",fontSize:11},children:["–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –º–æ–Ω–µ—Ç –∑–∞ –Ω–µ–¥–µ–ª—é (—Ü–µ–ª—å ",ce,")"]}),t.jsx("div",{style:{fontSize:16,fontWeight:600},children:z.coinsEarnedThisWeek.toLocaleString("ru-RU")}),t.jsx("div",{className:"progress-bar",children:t.jsx("div",{className:"progress-fill",style:{width:`${Math.min(1,z.coinsEarnedThisWeek/ce)*100}%`}})})]}),Ee&&t.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:Ms,style:{marginTop:4},children:["–ó–∞–±—Ä–∞—Ç—å ",$e," –º–æ–Ω–µ—Ç (—Ü–∏–∫–ª —Å–±—Ä–æ—Å–∏—Ç—Å—è)"]})]})]}),t.jsxs("div",{style:{padding:10,borderRadius:14,background:"rgba(15,23,42,0.9)",border:"1px solid rgba(34,197,94,0.4)",fontSize:12,marginBottom:10},children:[t.jsx("div",{style:{marginBottom:4,fontWeight:600},children:"–¶–µ–ª—å"}),t.jsxs("div",{style:{marginBottom:4},children:["‚Ä¢ –°–æ–±—Ä–∞—Ç—å –ª—é–±–æ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ 10 —Ä–∞–∑: ",Math.min(_.plantHarvests,10),"/10"]}),t.jsxs("div",{style:{marginBottom:6},children:["‚Ä¢ –ü–æ–∫–æ—Ä–º–∏—Ç—å –ª—é–±–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ 5 —Ä–∞–∑: ",Math.min(_.animalFeeds,5),"/5"]}),t.jsx("button",{type:"button",className:"btn btn-secondary",disabled:!Ae,onClick:Ws,children:"–ó–∞–±—Ä–∞—Ç—å 100 –º–æ–Ω–µ—Ç"})]}),g&&t.jsx(t.Fragment,{children:w?t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[t.jsxs("div",{style:{padding:12,borderRadius:14,background:"rgba(15,23,42,0.9)",border:"1px solid rgba(148,163,184,0.4)",fontSize:13},children:[t.jsx("div",{style:{marginBottom:6,fontWeight:600},children:"–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä—ã"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:"#9ca3af",fontSize:11},children:"–í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤"}),t.jsx("div",{style:{fontSize:20,fontWeight:600},children:w.totalUsers})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:"#9ca3af",fontSize:11},children:"–ê–∫—Ç–∏–≤–Ω—ã —Å–µ–≥–æ–¥–Ω—è"}),t.jsx("div",{style:{fontSize:20,fontWeight:600},children:w.activeToday})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:"#9ca3af",fontSize:11},children:"–†–µ—Ñ–µ—Ä–∞–ª–æ–≤"}),t.jsx("div",{style:{fontSize:20,fontWeight:600},children:w.totalReferrals})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:"#9ca3af",fontSize:11},children:"–í—Å–µ–≥–æ –≥–µ–º–æ–≤ üíé"}),t.jsx("div",{style:{fontSize:20,fontWeight:600},children:w.totalGems.toLocaleString("ru-RU")})]})]})]}),t.jsxs("div",{style:{fontSize:10,color:"#6b7280",textAlign:"center"},children:["–û–±–Ω–æ–≤–ª–µ–Ω–æ: ",new Date(w.updatedAt).toLocaleString("ru-RU")]})]}):t.jsx("div",{style:{fontSize:12,color:"#9ca3af"},children:"–ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏..."})})]})]}),t.jsxs("div",{className:"footer",children:[t.jsx("span",{children:xs||ws?"–ß–∞—Å—Ç—å —É—Ä–æ–∂–∞—è —É–∂–µ –≥–æ—Ç–æ–≤–∞ –∫ —Å–±–æ—Ä—É!":"–ó–∞–ø—É—Å—Ç–∏ —Ä–æ—Å—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–π—Å—è –ø–æ–∑–∂–µ."}),t.jsx("span",{children:"v0.6 Youdic"})]})]})})};export{dt as App};
