import{r as f,j as t}from"./index-JYqTFRxE.js";function K(){return{level:1,revision:0,resources:{coins:100,gems:5,tomato:0,cucumber:0,corn:0,watermelon:0,apple:0,milk:0,egg:0,cheese:0,meat:0,feathers:0,wool:0,feed:5},crops:[{id:"c1",type:"tomato",level:1,baseYield:3,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!0},{id:"c2",type:"cucumber",level:1,baseYield:2,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!0},{id:"c3",type:"tomato",level:1,baseYield:2,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!0},{id:"c4",type:"corn",level:1,baseYield:3,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!1},{id:"c5",type:"watermelon",level:1,baseYield:4,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!1},{id:"c6",type:"apple",level:1,baseYield:5,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!1}],animals:[{id:"a1",type:"cow",level:1,baseYield:1,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!0},{id:"a2",type:"chicken",level:1,baseYield:1,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!0},{id:"a3",type:"goat",level:1,baseYield:1,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!1},{id:"a4",type:"sheep",level:1,baseYield:1,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!1},{id:"a5",type:"pig",level:1,baseYield:1,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!1},{id:"a6",type:"goose",level:1,baseYield:1,timer:null,harvestsSinceLevel:0,gemUpgradeLevel:0,unlocked:!1}]}}const $s=60*1e3;function Qe(e){return{startedAt:Date.now(),durationMs:e*$s}}function Es(e){if(!e)return 0;const r=Date.now()-e.startedAt;return Math.min(1,Math.max(0,r/e.durationMs))}function $(e){return e?Date.now()-e.startedAt>=e.durationMs:!1}function Ms(e){const r=K().resources;return e?{...r,...e,coins:typeof e.coins=="number"?e.coins:r.coins,gems:typeof e.gems=="number"?e.gems:r.gems,tomato:typeof e.tomato=="number"?e.tomato:r.tomato??0,cucumber:typeof e.cucumber=="number"?e.cucumber:r.cucumber??0,corn:typeof e.corn=="number"?e.corn:0,watermelon:typeof e.watermelon=="number"?e.watermelon:0,apple:typeof e.apple=="number"?e.apple:0,milk:typeof e.milk=="number"?e.milk:0,egg:typeof e.egg=="number"?e.egg:0,cheese:typeof e.cheese=="number"?e.cheese:0,meat:typeof e.meat=="number"?e.meat:0,feathers:typeof e.feathers=="number"?e.feathers:0,wool:typeof e.wool=="number"?e.wool:0,feed:typeof e.feed=="number"?e.feed:r.feed??5}:{...r}}function Ws(e){const r=K(),a=Array.isArray(e.crops)?e.crops.filter(y=>y!=null&&typeof y=="object"&&y.id!=null):r.crops,c=Array.isArray(e.animals)?e.animals.filter(y=>y!=null&&typeof y=="object"&&y.id!=null):r.animals,d=new Map(a.map(y=>[y.id,y])),g=new Map(c.map(y=>[y.id,y])),p=r.crops.map(y=>{const S=d.get(y.id);return{...y,...S,harvestsSinceLevel:(S==null?void 0:S.harvestsSinceLevel)??0}}),w=r.animals.map(y=>{const S=g.get(y.id);return{...y,...S,harvestsSinceLevel:(S==null?void 0:S.harvestsSinceLevel)??0}}),j=Ms(e.resources);return{...e,resources:j,crops:p,animals:w}}function Bs(e,r){const a=e.crops.find(w=>w.id===r);if(!a)return e;let c=5;if(a.type==="corn"&&(c=10),a.type==="watermelon"&&(c=15),a.type==="apple"&&(c=20),e.resources.coins<c||a.timer)return e;let d;switch(a.type){case"tomato":d=3;break;case"cucumber":d=5;break;case"corn":d=6;break;case"watermelon":d=8;break;case"apple":d=10;break;default:d=5}const g=a.gemUpgradeLevel??0;return d=d/Math.pow(2,g),{...e,resources:{...e.resources,coins:e.resources.coins-c},crops:e.crops.map(w=>w.id===r?{...w,timer:Qe(d)}:w)}}function zs(e,r){const a=e.animals.find(w=>w.id===r);if(!a)return e;const c=1;if(e.resources.feed<c||a.timer)return e;let d;switch(a.type){case"cow":d=10;break;case"chicken":d=8;break;case"goat":d=9;break;case"sheep":d=9;break;case"pig":d=12;break;case"goose":d=7;break;default:d=10}const g=a.gemUpgradeLevel??0;return d=d/Math.pow(2,g),{...e,resources:{...e.resources,feed:e.resources.feed-c},animals:e.animals.map(w=>w.id===r?{...w,timer:Qe(d)}:w)}}function Os(e,r){const a=e.crops.find(h=>h.id===r);if(!a||!a.timer||!$(a.timer))return e;const c=a.gemUpgradeLevel??0,d=Math.pow(2,c),g=a.baseYield*d,p={...e.resources};a.type==="tomato"?p.tomato+=g:a.type==="cucumber"?p.cucumber+=g:a.type==="corn"?p.corn+=g:a.type==="watermelon"?p.watermelon+=g:a.type==="apple"&&(p.apple+=g);const j=(a.harvestsSinceLevel??0)+1,y=Math.floor(j/5),S=j%5;return{...e,resources:p,crops:e.crops.map(h=>h.id===r?{...h,timer:null,level:h.level+y,harvestsSinceLevel:S}:h)}}function _s(e,r){const a=e.animals.find(h=>h.id===r);if(!a||!a.timer||!$(a.timer))return e;const c=a.gemUpgradeLevel??0,d=Math.pow(2,c),g=a.baseYield*d,p={...e.resources};a.type==="cow"?p.milk+=g:a.type==="chicken"?p.egg+=g:a.type==="goat"?p.cheese+=g:a.type==="sheep"?p.wool+=g:a.type==="pig"?p.meat+=g:a.type==="goose"&&(p.feathers+=g);const j=(a.harvestsSinceLevel??0)+1,y=Math.floor(j/5),S=j%5;return{...e,resources:p,animals:e.animals.map(h=>h.id===r?{...h,timer:null,level:h.level+y,harvestsSinceLevel:S}:h)}}function Ps(e){const{tomato:r,cucumber:a,corn:c,watermelon:d,apple:g,milk:p,egg:w,cheese:j,meat:y,feathers:S,wool:C}=e.resources,h=_=>Math.round(_*1.25),O=r*h(3)+a*h(4)+c*h(5)+d*h(6)+g*h(6)+p*h(9)+w*h(6)+j*h(11)+y*h(13)+S*h(4)+C*h(7);return O===0?e:{...e,resources:{...e.resources,coins:e.resources.coins+O,tomato:0,cucumber:0,corn:0,watermelon:0,apple:0,milk:0,egg:0,cheese:0,meat:0,feathers:0,wool:0}}}function Ds(e){return e.resources.coins<20?e:{...e,resources:{...e.resources,coins:e.resources.coins-20,feed:e.resources.feed+5}}}const de=1;function Gs(e,r){const a=e.crops.find(p=>p.id===r);if(!a||!a.timer||$(a.timer))return e;const c=a.timer.durationMs-(Date.now()-a.timer.startedAt),d=Math.ceil(c/6e4),g=Math.max(1,d*de);return e.resources.gems<g?e:{...e,resources:{...e.resources,gems:e.resources.gems-g},crops:e.crops.map(p=>p.id===r?{...p,timer:{...p.timer,startedAt:Date.now()-p.timer.durationMs}}:p)}}function Fs(e,r){const a=e.animals.find(p=>p.id===r);if(!a||!a.timer||$(a.timer))return e;const c=a.timer.durationMs-(Date.now()-a.timer.startedAt),d=Math.ceil(c/6e4),g=Math.max(1,d*de);return e.resources.gems<g?e:{...e,resources:{...e.resources,gems:e.resources.gems-g},animals:e.animals.map(p=>p.id===r?{...p,timer:{...p.timer,startedAt:Date.now()-p.timer.durationMs}}:p)}}function Q(e){return e*50}function Hs(e,r){const a=e.crops.find(d=>d.id===r);if(!a)return e;const c=Q(a.level);return e.resources.coins<c?e:{...e,resources:{...e.resources,coins:e.resources.coins-c},crops:e.crops.map(d=>d.id===r?{...d,level:d.level+1}:d)}}function Ys(e,r){const a=e.animals.find(d=>d.id===r);if(!a)return e;const c=Q(a.level);return e.resources.coins<c?e:{...e,resources:{...e.resources,coins:e.resources.coins-c},animals:e.animals.map(d=>d.id===r?{...d,level:d.level+1}:d)}}function Ye(e){if(!e)return 0;const r=e.durationMs-(Date.now()-e.startedAt);return r<=0?0:Math.max(1,Math.ceil(r/6e4)*de)}function ce(){var e;try{return((e=window.Telegram)==null?void 0:e.WebApp)??null}catch{return null}}function Js(){var e,r;try{if(typeof window>"u")return{userId:"DEMO_USER",isTelegram:!1};const a=(e=window.Telegram)==null?void 0:e.WebApp;if(a&&((r=a.initDataUnsafe)!=null&&r.user)){const c=a.initDataUnsafe.user;return{userId:String(c.id),username:c.username,isTelegram:!0,startParam:a.initDataUnsafe.start_param}}try{const d=new URLSearchParams(window.location.search).get("uid");if(d)return{userId:String(d),isTelegram:!0,startParam:void 0}}catch{}return{userId:"DEMO_USER",isTelegram:!1}}catch{return{userId:"DEMO_USER",isTelegram:!1}}}function Ks(){var r;const e=(r=window.Telegram)==null?void 0:r.WebApp;e&&typeof e.ready=="function"&&e.ready()}const U="https://open-farm-1.onrender.com";async function Vs(e){try{const r=await fetch(`${U}/api/me?userId=${encodeURIComponent(e)}`,{credentials:"include"});return r.ok?await r.json():null}catch{return null}}async function Je(e,r,a){try{const c=await fetch(`${U}/api/farm/sync`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e,state:r,username:a??void 0})});return c.ok?await c.json():null}catch{return null}}async function qs(e,r){try{return(await fetch(`${U}/api/referral/bind`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e,referrerId:r})})).ok}catch{return!1}}async function Ke(e){try{const r=await fetch(`${U}/api/referral/stats?userId=${encodeURIComponent(e)}`,{credentials:"include"});if(!r.ok)return null;const a=await r.json();return{referredCount:a.referredCount??0,rewardsGems:a.rewardsGems??0}}catch{return null}}async function Qs(e){try{const r=await fetch(`${U}/api/daily/claim`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e})});return r.ok?await r.json():null}catch{return null}}const le=[{id:"gems_50",gems:50,stars:10,title:"50 –≥–µ–º–æ–≤",description:"50 –≥–µ–º–æ–≤ –∑–∞ 10 ‚≠ê"},{id:"gems_100",gems:100,stars:20,title:"100 –≥–µ–º–æ–≤",description:"100 –≥–µ–º–æ–≤ –∑–∞ 20 ‚≠ê"},{id:"gems_200",gems:200,stars:25,title:"200 –≥–µ–º–æ–≤",description:"200 –≥–µ–º–æ–≤ –∑–∞ 25 ‚≠ê"}];async function Ve(){try{const e=await fetch(`${U}/api/payments/packages`,{credentials:"include"});if(!e.ok)return le;const r=await e.json(),a=r==null?void 0:r.packages;if(Array.isArray(a)&&a.length>0&&a.every(c=>(c==null?void 0:c.id)&&typeof c.stars=="number"))return a}catch{}return le}async function Xs(e,r){try{const a=await fetch(`${U}/api/payments/create-invoice`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e,packageId:r})});return a.ok?await a.json():null}catch{return null}}async function Zs(e,r){try{const a=await fetch(`${U}/api/payments/create-custom-invoice`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e,gems:r})}),c=await a.json().catch(()=>null);return a.ok?c:c||{ok:!1,error:`HTTP ${a.status}`}}catch{return null}}async function W(e,r){try{const a=await fetch(`${U}/api/payments/confirm-paid`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e,...r})});return a.ok?await a.json():null}catch{return null}}async function et(){try{const e=await fetch(`${U}/api/stats`,{credentials:"include"});return e.ok?await e.json():null}catch{return null}}async function st(e,r,a,c){try{const d=await fetch(`${U}/api/admin/reward`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({adminId:e,targetUserId:r,resource:a,amount:c})});return d.ok?await d.json():null}catch{return null}}function tt(e){return`farm-miniapp-state-v1-${e}`}function nt(e,r){if(r)try{window.localStorage.setItem(tt(r),JSON.stringify(e))}catch{}}function rt(e){const r=Math.max(0,Math.round(e/1e3)),a=Math.floor(r/60),c=r%60;return a===0?`${c}s`:`${a}m ${c.toString().padStart(2,"0")}s`}function it(e){if(!e)return 0;const r=Date.now()-e.startedAt;return Math.max(0,e.durationMs-r)}const qe=({slot:e,kind:r,onAction:a,onBoost:c,onUpgrade:d,onGemUpgrade:g,canBoost:p,canUpgrade:w,canGemUpgrade:j,boostCost:y,upgradeCost:S,gemUpgradeLevel:C,maxGemUpgradeLevel:h})=>{const[O,_]=f.useState(!1),P=$(e.timer),Y=e.timer?Es(e.timer):0,X=e.timer?it(e.timer):0,E=r==="crop",Z=E?"–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤—Å–µ—Ö —Ä–∞—Å—Ç–µ–Ω–∏–π –Ω–∞ –≤—Ç–æ—Ä–æ–π —É—Ä–æ–≤–µ–Ω—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–æ–≤–æ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å –∑–∞ 30 –≥–µ–º–æ–≤.":"–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤—Å–µ—Ö —Ä–∞—Å—Ç–µ–Ω–∏–π –Ω–∞ –≤—Ç–æ—Ä–æ–π —É—Ä–æ–≤–µ–Ω—å –∏ –∂–∏–≤–æ—Ç–Ω—ã—Ö –Ω–∞ –ø–µ—Ä–≤—ã–π –∏ –≤—Ç–æ—Ä–æ–π —É—Ä–æ–≤–µ–Ω—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–æ–≤–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å –∑–∞ 30 –≥–µ–º–æ–≤.";let k="",N="",I="";if(E)switch(e.type){case"tomato":k="–ü–æ–º–∏–¥–æ—Ä—ã",N="üçÖ",I="—Ç–æ–º–∞—Ç—ã";break;case"cucumber":k="–û–≥—É—Ä—Ü—ã",N="ü•í",I="–æ–≥—É—Ä—Ü—ã";break;case"corn":k="–ö—É–∫—É—Ä—É–∑–∞",N="üåΩ",I="–∫—É–∫—É—Ä—É–∑–∞";break;case"watermelon":k="–ê—Ä–±—É–∑",N="üçâ",I="–∞—Ä–±—É–∑";break;case"apple":k="–Ø–±–ª–æ–∫–æ",N="üçé",I="—è–±–ª–æ–∫–∏";break;default:k="–ì—Ä—è–¥–∫–∞",N="üå±",I="—É—Ä–æ–∂–∞–π"}else switch(e.type){case"cow":k="–ö–æ—Ä–æ–≤–∞",N="üêÑ",I="–º–æ–ª–æ–∫–æ";break;case"chicken":k="–ö—É—Ä–∏—Ü–∞",N="üêî",I="—è–π—Ü–∞";break;case"goat":k="–ö–æ–∑–∞",N="üêê",I="—Å—ã—Ä";break;case"sheep":k="–û–≤—Ü–∞",N="üêë",I="—à–µ—Ä—Å—Ç—å";break;case"pig":k="–ü–æ—Ä–æ—Å—ë–Ω–æ–∫",N="üêñ",I="–º—è—Å–æ";break;case"goose":k="–ì—É—Å—å",N="ü¶¢",I="–ø–µ—Ä—å—è";break;default:k="–ñ–∏–≤–æ—Ç–Ω–æ–µ",N="üêæ",I="–ø—Ä–æ–¥—É–∫—Ü–∏—è"}const D=e.timer?P?"–°–æ–±—Ä–∞—Ç—å":"–ò–¥—ë—Ç —Ä–æ—Å—Ç":E?"–ü–æ—Å–∞–¥–∏—Ç—å":"–ü–æ–∫–æ—Ä–º–∏—Ç—å",G=e.timer&&!P&&y>0,J=e.harvestsSinceLevel??0;return t.jsx("div",{className:`tile ${E?"vegetable":"animal"}`,children:t.jsxs("div",{className:`tile-inner ${O?"is-flipped":""}`,children:[t.jsxs("div",{className:"tile-face tile-face-front",children:[t.jsxs("div",{className:"tile-header",children:[t.jsx("span",{className:"tile-name",children:k}),t.jsxs("span",{className:"tile-level",children:["–£—Ä. ",e.level]})]}),t.jsxs("div",{className:"tile-main",children:[t.jsx("span",{className:"tile-icon",children:N}),t.jsxs("div",{className:"tile-yield",children:[t.jsxs("div",{children:["–í—ã—Ö–æ–¥: √ó",e.baseYield*e.level," ",I]}),t.jsxs("div",{style:{fontSize:11,color:"#9ca3af"},children:["–î–æ —Å–ª–µ–¥. —É—Ä–æ–≤–Ω—è: ",J,"/5 —Å–±–æ—Ä–æ–≤"]}),e.timer&&t.jsxs("div",{className:"tile-timer",children:[P?"–ì–æ—Ç–æ–≤–æ –∫ —Å–±–æ—Ä—É":`–û—Å—Ç–∞–ª–æ—Å—å: ${rt(X)}`,t.jsx("div",{className:"progress-bar",children:t.jsx("div",{className:"progress-fill",style:{width:`${Y*100}%`}})})]}),!e.timer&&t.jsx("div",{className:"tile-timer",children:"–û–∂–∏–¥–∞–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è"})]})]}),t.jsxs("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:[t.jsx("button",{className:"btn btn-secondary",type:"button",onClick:a,style:{flex:1},children:D}),G&&t.jsxs("button",{className:"btn btn-primary",type:"button",onClick:c,disabled:!p,style:{fontSize:10,padding:"6px 8px"},title:p?`–£—Å–∫–æ—Ä–∏—Ç—å –∑–∞ ${y} üíé`:"–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –≥–µ–º–æ–≤",children:["‚ö° ",y,"üíé"]})]}),t.jsxs("div",{style:{display:"flex",gap:4,marginTop:4},children:[h>0&&t.jsxs("button",{className:"btn btn-secondary",type:"button",onClick:g,disabled:!j||C>=h,style:{fontSize:10,opacity:j&&C<h?1:.5},children:["üíé –£—Ä.",C,"/",h," ‚Äî ",r==="crop"?20:e.type==="cow"?30:e.type==="chicken"?20:60," üíé"]}),h>0&&t.jsx("button",{type:"button",onClick:()=>_(!0),style:{fontSize:10,color:"#9ca3af",marginLeft:4,alignSelf:"center",width:20,height:20,minWidth:20,padding:0,borderRadius:"50%",border:"1px solid rgba(148,163,184,0.5)",background:"rgba(15,23,42,0.8)",cursor:"pointer",lineHeight:1,display:"inline-flex",alignItems:"center",justifyContent:"center"},title:"–ü–æ–¥—Å–∫–∞–∑–∫–∞",children:"?"})]})]}),t.jsxs("div",{className:"tile-face tile-face-back",children:[t.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",fontSize:11,color:"#e2e8f0",padding:"0 8px"},children:t.jsx("div",{children:Z})}),t.jsx("div",{style:{display:"flex",justifyContent:"flex-end",padding:"0 6px 6px"},children:t.jsx("button",{type:"button",onClick:()=>_(!1),style:{fontSize:10,color:"#9ca3af",width:22,height:22,minWidth:22,padding:0,borderRadius:"50%",border:"1px solid rgba(148,163,184,0.5)",background:"rgba(15,23,42,0.9)",cursor:"pointer",lineHeight:1,display:"inline-flex",alignItems:"center",justifyContent:"center"},title:"–ù–∞–∑–∞–¥",children:"‚Ü©"})})]})]})})},v="https://open-farm-1.onrender.com",q="https://t.me/Youdic_Bot";function at(){var e;try{if(typeof window>"u")return!1;const r=(e=window.Telegram)==null?void 0:e.WebApp;return(r==null?void 0:r.platform)==="ios"?!0:typeof navigator<"u"&&/iPhone|iPad|iPod/i.test(navigator.userAgent||"")}catch{return!1}}const ct=()=>{var Ae,$e,Ee,Me,We,Be,ze,Oe,_e,Pe,De;const[e]=f.useState(()=>{try{return Js()}catch{return{userId:"DEMO_USER",isTelegram:!1}}}),[r,a]=f.useState(()=>K()),[c,d]=f.useState("fields"),[g]=f.useState(()=>{try{return new URLSearchParams(window.location.search).get("admin")==="1"}catch{return!1}}),[p,w]=f.useState(null),[j,y]=f.useState(null),[S,C]=f.useState(null),[h,O]=f.useState(null),[_,P]=f.useState(()=>le),[Y,X]=f.useState(""),[E,Z]=f.useState(""),[k,N]=f.useState("gems"),[I,D]=f.useState(null),G=f.useRef([]),J=f.useRef(r);f.useEffect(()=>{J.current=r},[r]);const F=f.useRef(!1),B=f.useCallback(()=>{e.userId&&Vs(e.userId).then(s=>{try{if(!s||s.level===void 0)return;const n=K(),i=s.revision,u=Ws({...n,level:s.level,resources:s.resources!=null?s.resources:n.resources,crops:Array.isArray(s.crops)?s.crops:n.crops,animals:Array.isArray(s.animals)?s.animals:n.animals,revision:typeof i=="number"?i:n.revision,referrerId:s.referrerId??void 0,referrerUsername:s.referrerUsername??void 0});a(u)}catch{}}).catch(()=>{})},[e.userId]),x=B,ee=f.useCallback(()=>{if(!e.userId)return;const s=J.current;if(s)try{const n=JSON.stringify({userId:e.userId,state:s,username:e.username??void 0});navigator.sendBeacon(`${v}/api/farm/sync`,new Blob([n],{type:"application/json"}))}catch{}},[v,e.userId,e.username]);f.useEffect(()=>{const s=()=>ee();window.addEventListener("pagehide",s),window.addEventListener("beforeunload",s);const n=()=>{document.visibilityState==="hidden"&&ee()};return document.addEventListener("visibilitychange",n),()=>{window.removeEventListener("pagehide",s),window.removeEventListener("beforeunload",s),document.removeEventListener("visibilitychange",n)}},[ee]),f.useEffect(()=>{if(!e.userId)return;const s=setInterval(()=>{if(F.current){const n=J.current;Je(e.userId,n,e.username).then(()=>{F.current=!1}).catch(()=>{})}},5e3);return()=>clearInterval(s)},[v,e.userId,e.username]);const ue=s=>`farm-miniapp-achievements-v1-${s}`,Xe=s=>{try{const n=window.localStorage.getItem(ue(s));if(!n)return{plantHarvests:0,animalFeeds:0,rewardClaimed:!1};const i=JSON.parse(n);return{plantHarvests:i.plantHarvests??0,animalFeeds:i.animalFeeds??0,rewardClaimed:!!i.rewardClaimed}}catch{return{plantHarvests:0,animalFeeds:0,rewardClaimed:!1}}},[z,se]=f.useState(()=>Xe(e.userId)),me=s=>`farm-miniapp-weekly-v1-${s}`,Ze=s=>{try{const n=window.localStorage.getItem(me(s));if(!n)return{harvestsThisWeek:0,coinsEarnedThisWeek:0};const i=JSON.parse(n);return{harvestsThisWeek:i.harvestsThisWeek??0,coinsEarnedThisWeek:i.coinsEarnedThisWeek??0}}catch{return{harvestsThisWeek:0,coinsEarnedThisWeek:0}}},[M,te]=f.useState(()=>Ze(e.userId)),es=(s,n)=>{if(n)try{window.localStorage.setItem(me(n),JSON.stringify(s))}catch{}},ss=(s,n)=>{if(n)try{window.localStorage.setItem(ue(n),JSON.stringify(s))}catch{}};f.useEffect(()=>{ss(z,e.userId)},[z,e.userId]),f.useEffect(()=>{es(M,e.userId)},[M,e.userId]),f.useEffect(()=>{Ve().then(s=>s.length>0&&P(s)).catch(()=>{})},[]),f.useEffect(()=>{e.isTelegram&&c==="referrals"&&v&&e.userId&&Ke(e.userId).then(w),e.isTelegram&&c==="stats"&&v&&et().then(y)},[c,e.userId,e.isTelegram,B]),f.useEffect(()=>{nt(r,e.userId)},[r,e.userId]),f.useEffect(()=>{if(e.userId){B();return}},[e.userId,B]),f.useEffect(()=>{Ks();const s=e.startParam;if(e.isTelegram&&v&&s&&s.startsWith("ref_")&&e.userId){const i=s.slice(4);i&&qs(e.userId,i)}e.isTelegram&&v&&e.userId&&(Ke(e.userId).then(w).catch(()=>{}),Ve().then(P).catch(()=>{}));const n=window.setInterval(()=>{a(i=>({...i}))},1e3);return()=>window.clearInterval(n)},[e.isTelegram,e.userId,B]),f.useEffect(()=>{e.userId==="DEMO_USER"&&window.location.replace(`${q}?start=app`)},[e.userId]),f.useEffect(()=>{c!=="shop"||!v||!e.userId||x()},[c,v,e.userId,x]),f.useEffect(()=>{if(c!=="shop"||!v||!e.userId)return;const s=setInterval(x,5e3);return()=>clearInterval(s)},[c,v,e.userId,x]),f.useEffect(()=>{if(!e.userId||!e.isTelegram)return;const s=()=>{x(),G.current.push(setTimeout(x,1e3)),G.current.push(setTimeout(x,3e3))};let n=document.visibilityState==="hidden";const i=()=>{n&&document.visibilityState==="visible"&&s(),n=document.visibilityState==="hidden"};return document.addEventListener("visibilitychange",i),window.addEventListener("focus",s),()=>{document.removeEventListener("visibilitychange",i),window.removeEventListener("focus",s),G.current.forEach(clearTimeout),G.current=[]}},[v,e.userId,e.isTelegram,x]),f.useEffect(()=>{const s=ce();if(!(s!=null&&s.onEvent)||!v||!e.userId)return;const n=i=>{((i==null?void 0:i.status)==="paid"||(i==null?void 0:i.status)==="completed")&&B()};return s.onEvent("invoiceClosed",n),()=>{s.offEvent&&s.offEvent("invoiceClosed",n)}},[v,e.userId,B]);const T=f.useCallback(s=>{a(n=>{const i=n??K(),u=s(i),m=(i.revision??0)+1,l={...u,revision:m};return F.current=!0,e.userId&&Je(e.userId,l,e.username).then(()=>{F.current=!1}).catch(()=>{}),l})},[v,e.userId,e.username]),ts=s=>{T(n=>Bs(n,s))},ns=s=>{T(n=>zs(n,s)),se(n=>({...n,animalFeeds:n.animalFeeds+1}))},rs=s=>{T(n=>Os(n,s)),se(n=>({...n,plantHarvests:n.plantHarvests+1})),te(n=>({...n,harvestsThisWeek:n.harvestsThisWeek+1}))},is=s=>{T(n=>_s(n,s))},as=()=>{T(s=>{var u;const n=Ps(s),i=n.resources.coins-(((u=s.resources)==null?void 0:u.coins)??0);return te(m=>({...m,coinsEarnedThisWeek:m.coinsEarnedThisWeek+i})),n})},os=()=>{T(s=>Ds(s))},cs=s=>{T(n=>Gs(n,s))},ls=s=>{T(n=>Fs(n,s))},ds=s=>{T(n=>Hs(n,s))},us=s=>{T(n=>Ys(n,s))},ms=async()=>{if(!e.userId){C("–ü–æ–¥–∫–ª—é—á–∏ backend (VITE_API_URL) –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –Ω–∞–≥—Ä–∞–¥—ã.");return}const s=await Qs(e.userId);if(!s){C("–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞.");return}if(O(s),s.claimed&&s.reward&&s.resources){const n=[];s.reward.coins&&n.push(`${s.reward.coins} –º–æ–Ω–µ—Ç`),s.reward.gems&&n.push(`${s.reward.gems} –≥–µ–º–æ–≤`),s.reward.feed&&n.push(`${s.reward.feed} –∫–æ—Ä–º–∞`),C(`–ù–∞–≥—Ä–∞–¥–∞: ${n.join(", ")}. –ú–∞—Ä–∞—Ñ–æ–Ω: –¥–µ–Ω—å ${s.streak??1} –∏–∑ 5.`),T(i=>({...i,resources:{...i.resources,...s.resources}}))}else if(!s.claimed){const n=s.nextAt?new Date(s.nextAt).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"}):"";C(`–£–∂–µ –∑–∞–±—Ä–∞–ª —Å–µ–≥–æ–¥–Ω—è. –°–ª–µ–¥—É—é—â–∞—è –Ω–∞–≥—Ä–∞–¥–∞ –ø–æ—Å–ª–µ ${n}`)}},fs=(r.resources.coins??0).toLocaleString("ru-RU"),ps=(r.resources.gems??0).toLocaleString("ru-RU"),hs=(r.resources.feed??0).toLocaleString("ru-RU"),gs=r.crops.some(s=>$(s.timer)),ys=r.animals.some(s=>$(s.timer)),fe=`https://t.me/Youdic_Bot?start=ref_${e.userId}`,bs=async()=>{try{await navigator.clipboard.writeText(fe)}catch{}},pe=(s,n)=>{const i=m=>n.crops.find(l=>l.id===m),u=m=>((m==null?void 0:m.gemUpgradeLevel)??0)>=2;return s==="corn"?u(i("c1"))&&u(i("c2"))&&u(i("c3")):s==="watermelon"?u(i("c4")):s==="apple"?u(i("c5")):!1},he=(s,n)=>{const i=o=>n.animals.find(b=>b.type===o),u=o=>n.crops.find(b=>b.id===o),m=o=>((o==null?void 0:o.gemUpgradeLevel)??0)>=2,l=o=>((o==null?void 0:o.gemUpgradeLevel)??0)>=2;if(s==="goat"){const o=i("cow"),b=i("chicken"),R=m(u("c1"))&&m(u("c2"))&&m(u("c3")),H=((o==null?void 0:o.gemUpgradeLevel)??0)>=1&&((b==null?void 0:b.gemUpgradeLevel)??0)>=1;return R&&H}return s==="sheep"?l(i("goat")):s==="pig"?l(i("sheep")):s==="goose"?l(i("pig")):!1},vs=s=>{T(n=>{const i=n.crops.find(u=>u.id===s);return!i||i.unlocked||n.resources.gems<30||!pe(i.type,n)?n:{...n,resources:{...n.resources,gems:n.resources.gems-30},crops:n.crops.map(u=>u.id===s?{...u,unlocked:!0}:u)}})},xs=s=>{T(n=>{const i=n.animals.find(u=>u.id===s);return!i||i.unlocked||n.resources.gems<30||!he(i.type,n)?n:{...n,resources:{...n.resources,gems:n.resources.gems-30},animals:n.animals.map(u=>u.id===s?{...u,unlocked:!0}:u)}})},ge=s=>{switch(s){case"tomato":case"cucumber":case"corn":case"watermelon":case"apple":return 2;default:return 0}},ye=s=>{switch(s){case"cow":return 1;case"chicken":return 1;case"goat":case"sheep":case"pig":case"goose":return 2;default:return 0}},ws=s=>{T(n=>{const i=n.crops.map(m=>{if(m.id!==s)return m;const l=m.gemUpgradeLevel??0,o=ge(m.type);return l>=o||n.resources.gems<20?m:{...m,gemUpgradeLevel:l+1}});return n.crops!==i?{...n,resources:{...n.resources,gems:n.resources.gems-20},crops:i}:n})},js=s=>{T(n=>{const i=n.animals.map(o=>{if(o.id!==s)return o;const b=o.gemUpgradeLevel??0,R=ye(o.type);if(b>=R)return o;const H=o.type==="cow"?30:o.type==="chicken"?20:60;return n.resources.gems<H?o:{...o,gemUpgradeLevel:b+1}});if(!(n.animals!==i))return n;const m=i.find((o,b)=>o.gemUpgradeLevel!==(n.animals[b].gemUpgradeLevel??0));if(!m)return n;const l=m.type==="cow"?30:m.type==="chicken"?20:60;return{...n,resources:{...n.resources,gems:n.resources.gems-l},animals:i}})},Ss=()=>{a(s=>s.resources.gems<10?s:{...s,resources:{...s.resources,gems:s.resources.gems-10,coins:s.resources.coins+100}})},be=1e5,ks=1e4,Is=()=>{a(s=>(s.resources.coins??0)<be?s:{...s,resources:{...s.resources,coins:(s.resources.coins??0)-be,gems:(s.resources.gems??0)+ks}})},[ve,xe]=f.useState(null),[we,Ts]=f.useState(""),[je,Se]=f.useState(!1),[ke,A]=f.useState(null),ne=s=>`farm-miniapp-custom-username-v1-${s}`,[re,Ns]=f.useState(()=>{try{return window.localStorage.getItem(ne(e.userId))||""}catch{return""}}),[Cs,Ie]=f.useState(!1),[Te,Ne]=f.useState(""),V=f.useCallback(()=>{x(),setTimeout(x,1e3),setTimeout(x,2500),setTimeout(x,5e3),setTimeout(x,1e4),setTimeout(x,2e4)},[x]),Ls=async s=>{if(!e.userId||!v){alert("–ü–æ–∫—É–ø–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ Telegram");return}xe(s);try{const n=await Xs(e.userId,s);if(!(n!=null&&n.invoiceLink)){alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç—ë–∂");return}const i=ce(),u=()=>{try{V()}catch{x()}},m=()=>{A({packageId:s});const o=()=>{x(),setTimeout(x,400),V()};e.userId&&v?W(e.userId,{packageId:s}).then(b=>{if(b!=null&&b.ok){A(null),o();return}setTimeout(()=>W(e.userId,{packageId:s}).then(R=>{R!=null&&R.ok&&A(null),o()}),1500)}).catch(()=>{setTimeout(()=>W(e.userId,{packageId:s}).then(b=>{b!=null&&b.ok&&A(null),o()}),1500)}):o()},l=o=>o==="paid"||o==="completed"||typeof o=="object"&&o!==null&&o.status==="paid";if(i!=null&&i.openInvoice){try{i.openInvoice(n.invoiceLink,o=>{const b=typeof o=="object"&&o!==null&&"status"in o?o.status:String(o);(l(b)||l(o))&&m()})}catch{}u()}else if(i!=null&&i.openTelegramLink){try{i.openTelegramLink(n.invoiceLink),i.platform==="ios"&&i.showAlert&&i.showAlert("–ï—Å–ª–∏ –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã –Ω–µ –æ—Ç–∫—Ä—ã–ª–æ—Å—å ‚Äî –Ω–∞–∂–º–∏—Ç–µ –≤–Ω–∏–∑—É ¬´–û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã¬ª, –∑–∞—Ç–µ–º –≤ —á–∞—Ç–µ –≤–≤–µ–¥–∏—Ç–µ /donate –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø–∞–∫–µ—Ç.")}catch{}u()}else window.open(n.invoiceLink,"_blank"),u()}catch{alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–∞")}finally{xe(null)}},L=Number(we.replace(/\D/g,"")),Ce=L>0?Math.max(1,Math.ceil(L/5)):0,Us=async()=>{if(!e.userId||!v){alert("–ü–æ–∫—É–ø–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ Telegram");return}if(!(!L||L<=0)){Se(!0);try{const s=await Zs(e.userId,L);if(!(s!=null&&s.invoiceLink)){const l=(s==null?void 0:s.error)||"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç—ë–∂";alert(l);return}const n=ce(),i=()=>{try{V()}catch{x()}},u=()=>{A({gems:L});const l=()=>{x(),setTimeout(x,400),V()};e.userId&&v?W(e.userId,{gems:L}).then(o=>{if(o!=null&&o.ok){A(null),l();return}setTimeout(()=>W(e.userId,{gems:L}).then(b=>{b!=null&&b.ok&&A(null),l()}),1500)}).catch(()=>{setTimeout(()=>W(e.userId,{gems:L}).then(o=>{o!=null&&o.ok&&A(null),l()}),1500)}):l()},m=l=>l==="paid"||l==="completed"||typeof l=="object"&&l!==null&&l.status==="paid";if(n!=null&&n.openInvoice){try{n.openInvoice(s.invoiceLink,l=>{const o=typeof l=="object"&&l!==null&&"status"in l?l.status:String(l);(m(o)||m(l))&&u()})}catch{}i()}else if(n!=null&&n.openTelegramLink){try{n.openTelegramLink(s.invoiceLink),n.platform==="ios"&&n.showAlert&&n.showAlert("–ï—Å–ª–∏ –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã –Ω–µ –æ—Ç–∫—Ä—ã–ª–æ—Å—å ‚Äî –Ω–∞–∂–º–∏—Ç–µ –≤–Ω–∏–∑—É ¬´–û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã¬ª, –∑–∞—Ç–µ–º –≤ —á–∞—Ç–µ –≤–≤–µ–¥–∏—Ç–µ /donate –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ—é —Å—É–º–º—É.")}catch{}i()}else window.open(s.invoiceLink,"_blank"),i()}catch{alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–∞")}finally{Se(!1)}}},Le=z.plantHarvests>=10&&z.animalFeeds>=5&&!z.rewardClaimed,ie=100,ae=1e3,Ue=200,Re=M.harvestsThisWeek>=ie&&M.coinsEarnedThisWeek>=ae,Rs=()=>{if(!Re)return;T(n=>({...n,resources:{...n.resources,coins:(n.resources.coins??0)+Ue}})),te({harvestsThisWeek:0,coinsEarnedThisWeek:0})},As=()=>{if(!Le)return;const s=100;T(n=>({...n,resources:{...n.resources,coins:(n.resources.coins??0)+s}})),se(n=>({...n,rewardClaimed:!0}))};return e.userId==="DEMO_USER"?t.jsx("div",{className:"app-root",children:t.jsx("div",{className:"card",style:{padding:24,textAlign:"center"},children:t.jsx("div",{style:{fontSize:18},children:"–û—Ç–∫—Ä—ã–≤–∞–µ–º‚Ä¶"})})}):t.jsx("div",{className:"app-root",children:t.jsxs("div",{className:"card",children:[t.jsxs("div",{className:"card-header",children:[t.jsxs("div",{children:[t.jsx("div",{className:"title",children:"–¢–æ–º–∞—Ç–Ω–∞—è —Ñ–µ—Ä–º–∞"}),t.jsxs("div",{className:"subtitle",children:[e.username?`@${e.username}`:"–ú–∏–Ω–∏‚Äë–∞–ø–ø"," ¬∑ –£—Ä. ",r.level]})]}),t.jsx("div",{style:{fontSize:18},children:"üöú"})]}),t.jsxs("div",{className:"resources",children:[t.jsxs("div",{className:"pill",children:[t.jsx("span",{className:"pill-label",children:"–ú–æ–Ω–µ—Ç—ã"}),t.jsxs("span",{className:"pill-value",children:["ü™ô ",fs]})]}),t.jsxs("div",{className:"pill secondary",children:[t.jsx("span",{className:"pill-label",children:"–ì–µ–º—ã"}),t.jsxs("span",{className:"pill-value",children:["üíé ",ps]})]}),t.jsxs("div",{className:"pill secondary",children:[t.jsx("span",{className:"pill-label",children:"–ö–æ—Ä–º"}),t.jsxs("span",{className:"pill-value",children:["ü•£ ",hs]})]})]}),t.jsxs("div",{className:"tabs",children:[t.jsx("button",{type:"button",className:`tab ${c==="fields"?"active":""}`,onClick:()=>d("fields"),children:"–ì—Ä—è–¥–∫–∏"}),t.jsx("button",{type:"button",className:`tab ${c==="animals"?"active":""}`,onClick:()=>d("animals"),children:"–ñ–∏–≤–æ—Ç–Ω—ã–µ"}),t.jsx("button",{type:"button",className:`tab ${c==="market"?"active":""}`,onClick:()=>d("market"),children:"–†—ã–Ω–æ–∫"}),t.jsx("button",{type:"button",className:`tab ${c==="referrals"?"active":""}`,onClick:()=>d("referrals"),children:"–†–µ—Ñ–µ—Ä–∞–ª—ã"}),t.jsx("button",{type:"button",className:`tab ${c==="shop"?"active":""}`,onClick:()=>d("shop"),children:"–ú–∞–≥–∞–∑–∏–Ω"}),t.jsx("button",{type:"button",className:`tab ${c==="stats"?"active":""}`,onClick:()=>d("stats"),children:"üìä"})]}),t.jsxs("div",{className:"card-content",children:[c==="fields"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"section-title-row",children:[t.jsx("div",{className:"section-title",children:"–ì—Ä—è–¥–∫–∏"}),t.jsx("div",{className:"section-caption",children:"–¢—Ä–∞—Ç—å –º–æ–Ω–µ—Ç—ã, —á—Ç–æ–±—ã –ø–æ—Å–∞–¥–∏—Ç—å, –∏ —Å–æ–±–∏—Ä–∞–π —É—Ä–æ–∂–∞–π"})]}),t.jsx("div",{className:"grid",children:(r.crops??[]).map(s=>{if(s.unlocked===!1){const l=pe(s.type,r),o={tomato:"–ü–æ–º–∏–¥–æ—Ä—ã",cucumber:"–û–≥—É—Ä—Ü—ã",corn:"–ö—É–∫—É—Ä—É–∑–∞",watermelon:"–ê—Ä–±—É–∑",apple:"–Ø–±–ª–æ–∫–æ"};return t.jsxs("div",{className:"tile vegetable",style:{opacity:.7,display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[t.jsxs("div",{className:"tile-header",children:[t.jsx("span",{className:"tile-name",children:o[s.type]}),t.jsx("span",{className:"tile-level",children:"üîí"})]}),t.jsxs("div",{className:"tile-main",children:[t.jsx("span",{className:"tile-icon",children:"üå±"}),t.jsxs("div",{className:"tile-yield",children:[t.jsx("div",{style:{fontSize:10,color:"#9ca3af"},children:"–û—Ç–∫—Ä–æ–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —É—Å–ª–æ–≤–∏–π"}),t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>vs(s.id),disabled:!l||r.resources.gems<30,style:{marginTop:4,fontSize:10},children:"–û—Ç–∫—Ä—ã—Ç—å –∑–∞ 30 üíé"})]})]})]},s.id)}const n=Ye(s.timer),i=Q(s.level),u=s.gemUpgradeLevel??0,m=ge(s.type);return t.jsx(qe,{slot:s,kind:"crop",onAction:()=>{s.timer?$(s.timer)&&rs(s.id):ts(s.id)},onBoost:()=>cs(s.id),onUpgrade:()=>ds(s.id),onGemUpgrade:()=>ws(s.id),canBoost:r.resources.gems>=n&&n>0,canUpgrade:r.resources.coins>=i,canGemUpgrade:r.resources.gems>=20&&u<m,boostCost:n,upgradeCost:i,gemUpgradeLevel:u,maxGemUpgradeLevel:m},s.id)})})]}),c==="animals"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"section-title-row",children:[t.jsx("div",{className:"section-title",children:"–ñ–∏–≤–æ—Ç–Ω—ã–µ"}),t.jsx("div",{className:"section-caption",children:"–¢—Ä–∞—Ç—å –∫–æ—Ä–º, —á—Ç–æ–±—ã –æ–Ω–∏ –ø—Ä–∏–Ω–æ—Å–∏–ª–∏ –º–æ–ª–æ–∫–æ –∏ —è–π—Ü–∞"})]}),t.jsx("div",{className:"grid",children:(r.animals??[]).map(s=>{if(s.unlocked===!1){const l=he(s.type,r),o={cow:"–ö–æ—Ä–æ–≤–∞",chicken:"–ö—É—Ä–∏—Ü–∞",goat:"–ö–æ–∑–∞",sheep:"–û–≤—Ü–∞",pig:"–ü–æ—Ä–æ—Å—ë–Ω–æ–∫",goose:"–ì—É—Å—å"};return t.jsxs("div",{className:"tile animal",style:{opacity:.7,display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[t.jsxs("div",{className:"tile-header",children:[t.jsx("span",{className:"tile-name",children:o[s.type]}),t.jsx("span",{className:"tile-level",children:"üîí"})]}),t.jsxs("div",{className:"tile-main",children:[t.jsx("span",{className:"tile-icon",children:"üêæ"}),t.jsxs("div",{className:"tile-yield",children:[t.jsx("div",{style:{fontSize:10,color:"#9ca3af"},children:"–û—Ç–∫—Ä–æ–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —É—Å–ª–æ–≤–∏–π"}),t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>xs(s.id),disabled:!l||r.resources.gems<30,style:{marginTop:4,fontSize:10},children:"–û—Ç–∫—Ä—ã—Ç—å –∑–∞ 30 üíé"})]})]})]},s.id)}const n=Ye(s.timer),i=Q(s.level),u=s.gemUpgradeLevel??0,m=ye(s.type);return t.jsx(qe,{slot:s,kind:"animal",onAction:()=>{s.timer?$(s.timer)&&is(s.id):ns(s.id)},onBoost:()=>ls(s.id),onUpgrade:()=>us(s.id),onGemUpgrade:()=>js(s.id),canBoost:r.resources.gems>=n&&n>0,canUpgrade:r.resources.coins>=i,canGemUpgrade:r.resources.gems>=(s.type==="cow"?30:s.type==="chicken"?20:60)&&u<m,boostCost:n,upgradeCost:i,gemUpgradeLevel:u,maxGemUpgradeLevel:m},s.id)})})]}),c==="market"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"section-title-row",children:[t.jsx("div",{className:"section-title",children:"–†—ã–Ω–æ–∫ –∏ –ª–∞–≤–∫–∞"}),t.jsx("div",{className:"section-caption",children:"–ü—Ä–æ–¥–∞–≤–∞–π –ø—Ä–æ–¥—É–∫—Ü–∏—é –∏ –ø–æ–∫—É–ø–∞–π –∫–æ—Ä–º, –∑–∞–±–∏—Ä–∞–π –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –±–æ–Ω—É—Å—ã."})]}),t.jsxs("div",{style:{fontSize:12,marginBottom:8,color:"#9ca3af"},children:["–£—Ä–æ–∂–∞–π:"," ","üçÖ ",(((Ae=r.resources)==null?void 0:Ae.tomato)??0).toLocaleString("ru-RU")," ¬∑ ","ü•í ",((($e=r.resources)==null?void 0:$e.cucumber)??0).toLocaleString("ru-RU")," ¬∑ ","ü•õ ",(((Ee=r.resources)==null?void 0:Ee.milk)??0).toLocaleString("ru-RU")," ¬∑ ","ü•ö ",(((Me=r.resources)==null?void 0:Me.egg)??0).toLocaleString("ru-RU")," ¬∑ ","üåΩ ",(((We=r.resources)==null?void 0:We.corn)??0).toLocaleString("ru-RU")," ¬∑ ","üçâ ",(((Be=r.resources)==null?void 0:Be.watermelon)??0).toLocaleString("ru-RU")," ¬∑ ","üçé ",(((ze=r.resources)==null?void 0:ze.apple)??0).toLocaleString("ru-RU")," ¬∑ ","üßÄ ",(((Oe=r.resources)==null?void 0:Oe.cheese)??0).toLocaleString("ru-RU")," ¬∑ ","ü•© ",(((_e=r.resources)==null?void 0:_e.meat)??0).toLocaleString("ru-RU")," ¬∑ ","ü™∂ ",(((Pe=r.resources)==null?void 0:Pe.feathers)??0).toLocaleString("ru-RU")," ¬∑ ","üß∂ ",(((De=r.resources)==null?void 0:De.wool)??0).toLocaleString("ru-RU")]}),t.jsxs(t.Fragment,{children:[t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:ms,style:{marginBottom:6},children:"üéÅ –ó–∞–±—Ä–∞—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é –Ω–∞–≥—Ä–∞–¥—É"}),S&&t.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4},children:S}),(h==null?void 0:h.streak)&&t.jsxs("div",{style:{fontSize:10,color:"#6b7280",marginBottom:6},children:["–ú–∞—Ä–∞—Ñ–æ–Ω: –¥–µ–Ω—å ",h.streak," –∏–∑ 5 (–¥–µ–Ω—å 1: 20ü™ô+5ü•£, 2: 30+5, 3: 40+5, 4: 50+5, 5: 100üíé+20ü•£)"]})]}),t.jsx("button",{type:"button",className:"btn btn-primary",onClick:as,children:"–ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë –Ω–∞ —Ä—ã–Ω–∫–µ"}),t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:os,style:{marginTop:6},children:"–ö—É–ø–∏—Ç—å –∫–æ—Ä–º (5 —à—Ç. –∑–∞ 20 –º–æ–Ω–µ—Ç)"}),t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:Ss,style:{marginTop:6},disabled:(r.resources.gems??0)<10,children:"–û–±–º–µ–Ω—è—Ç—å 10 üíé –Ω–∞ 100 ü™ô"}),t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:Is,style:{marginTop:6},disabled:(r.resources.coins??0)<1e5,children:"–û–±–º–µ–Ω—è—Ç—å 100‚ÄØ000 ü™ô –Ω–∞ 10‚ÄØ000 üíé"})]}),c==="referrals"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"section-title-row",children:[t.jsx("div",{className:"section-title",children:"–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞"}),t.jsx("div",{className:"section-caption",children:"–î–µ–ª–∏—Å—å —Å—Å—ã–ª–∫–æ–π –∏ –ø–æ–ª—É—á–∞–π –≥–µ–º—ã –∑–∞ –¥—Ä—É–∑–µ–π."})]}),p!==null&&t.jsxs("div",{style:{fontSize:12,color:"#e5e7eb",marginBottom:8,display:"flex",gap:12},children:[t.jsxs("span",{children:["–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ: ",t.jsx("strong",{children:p.referredCount})]}),t.jsxs("span",{children:["–ù–∞–≥—Ä–∞–¥–∞: ",t.jsxs("strong",{children:[p.rewardsGems," üíé"]})]})]}),t.jsxs("div",{style:{fontSize:12,color:"#9ca3af",marginBottom:8,display:"flex",alignItems:"center",gap:6,flexWrap:"wrap"},children:[t.jsx("span",{children:"–¢–≤–æ–π —é–∑–µ—Ä–Ω–µ–π–º:"}),Cs?t.jsxs(t.Fragment,{children:[t.jsx("input",{type:"text",value:Te,onChange:s=>Ne(s.target.value),placeholder:"–í–≤–µ–¥–∏ —é–∑–µ—Ä–Ω–µ–π–º",style:{flex:1,minWidth:120,padding:"6px 10px",borderRadius:8,border:"1px solid rgba(148,163,184,0.5)",background:"rgba(15,23,42,0.9)",color:"#e5e7eb",fontSize:12},autoFocus:!0}),t.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>{const s=Te.trim();try{s?window.localStorage.setItem(ne(e.userId),s):window.localStorage.removeItem(ne(e.userId))}catch{}Ns(s),Ie(!1)},style:{fontSize:12,padding:"6px 12px"},children:"OK"})]}):t.jsxs(t.Fragment,{children:[t.jsx("strong",{style:{color:"#e5e7eb"},children:re?`@${re.replace(/^@/,"")}`:e.username?`@${e.username}`:"‚Äî"}),t.jsx("button",{type:"button",onClick:()=>{Ne(re||e.username||""),Ie(!0)},title:"–ò–∑–º–µ–Ω–∏—Ç—å —é–∑–µ—Ä–Ω–µ–π–º",style:{width:28,height:28,borderRadius:"50%",border:"1px solid rgba(148,163,184,0.5)",background:"rgba(30,41,59,0.8)",color:"#94a3b8",fontSize:14,display:"inline-flex",alignItems:"center",justifyContent:"center",cursor:"pointer",padding:0},children:"‚úèÔ∏è"})]})]}),r.referrerId&&t.jsxs("div",{style:{fontSize:12,color:"#9ca3af",marginBottom:8},children:["–í–∞—Å –ø—Ä–∏–≥–ª–∞—Å–∏–ª: ",t.jsx("strong",{style:{color:"#e5e7eb"},children:r.referrerUsername?`@${r.referrerUsername}`:"–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"})]}),g&&t.jsxs("div",{style:{marginTop:12,padding:8,borderRadius:8,border:"1px dashed rgba(148,163,184,0.6)",background:"rgba(15,23,42,0.8)"},children:[t.jsx("div",{style:{fontSize:11,color:"#f97316",marginBottom:4},children:"–ê–¥–º–∏–Ω: —Ä–∞–∑–æ–≤–∞—è –Ω–∞–≥—Ä–∞–¥–∞ –∏–≥—Ä–æ–∫—É"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[t.jsx("input",{type:"text",placeholder:"ID –∏–≥—Ä–æ–∫–∞ (userId)",value:Y,onChange:s=>X(s.target.value),style:{padding:"6px 8px",borderRadius:6,border:"1px solid rgba(148,163,184,0.6)",fontSize:12,background:"rgba(15,23,42,0.9)",color:"#e5e7eb"}}),t.jsxs("div",{style:{display:"flex",gap:6},children:[t.jsx("input",{type:"number",min:1,placeholder:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ",value:E,onChange:s=>Z(s.target.value),style:{flex:1,padding:"6px 8px",borderRadius:6,border:"1px solid rgba(148,163,184,0.6)",fontSize:12,background:"rgba(15,23,42,0.9)",color:"#e5e7eb"}}),t.jsxs("select",{value:k,onChange:s=>N(s.target.value),style:{padding:"6px 8px",borderRadius:6,border:"1px solid rgba(148,163,184,0.6)",fontSize:12,background:"rgba(15,23,42,0.9)",color:"#e5e7eb"},children:[t.jsx("option",{value:"gems",children:"üíé –ì–µ–º—ã"}),t.jsx("option",{value:"coins",children:"ü™ô –ú–æ–Ω–µ—Ç—ã"})]})]}),t.jsxs("button",{type:"button",className:"btn btn-secondary",style:{fontSize:12,padding:"6px 10px"},onClick:async()=>{const s=Math.floor(Number(E||"0"));if(!Y.trim()||!s||s<=0){D("–£–∫–∞–∂–∏ ID –∏–≥—Ä–æ–∫–∞ –∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ.");return}D("–û—Ç–ø—Ä–∞–≤–ª—è—é –Ω–∞–≥—Ä–∞–¥—É‚Ä¶");const n=await st(e.userId,Y.trim(),k,s);n!=null&&n.ok?D("–ù–∞–≥—Ä–∞–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞."):D("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –Ω–∞–≥—Ä–∞–¥—ã.")},children:["–ù–∞—á–∏—Å–ª–∏—Ç—å ",E||"?"," ",k==="gems"?"üíé":"ü™ô"]}),I&&t.jsx("div",{style:{fontSize:10,color:"#9ca3af"},children:I})]})]}),t.jsxs("div",{style:{fontSize:11,background:"rgba(15,23,42,0.9)",borderRadius:12,padding:8,border:"1px solid rgba(148,163,184,0.4)",wordBreak:"break-all"},children:[t.jsx("div",{style:{marginBottom:4},children:"–¢–≤–æ—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞:"}),t.jsxs("div",{style:{marginBottom:6},children:["https://t.me/Youdic_Bot?start=ref_",e.userId]}),t.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:bs,style:{flex:1,minWidth:120},children:"–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É"}),t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{const s=encodeURIComponent("–ó–∞—Ö–æ–¥–∏ –≤ –º–æ—é —Ç–æ–º–∞—Ç–Ω—É—é —Ñ–µ—Ä–º—É –∏ –ø–æ–ª—É—á–∏ –±–æ–Ω—É—Å:"),i=`https://t.me/share/url?url=${encodeURIComponent(fe)}&text=${s}`;window.open(i,"_blank")},style:{flex:1,minWidth:120},children:"–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥—Ä—É–≥—É"})]})]}),t.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginTop:10},children:"–ó–∞ –ø–µ—Ä–≤—ã—Ö —Ç—Ä—ë—Ö –¥—Ä—É–∑–µ–π —Ç—ã –ø–æ–ª—É—á–∞–µ—à—å –ø–æ 10 üíé, –∞ –∫–æ–≥–¥–∞ –ø—Ä–∏–≥–ª–∞—Å–∏—à—å 5 ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ 25 üíé."})]}),c==="shop"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"section-title-row",children:[t.jsx("div",{className:"section-title",children:"–ú–∞–≥–∞–∑–∏–Ω"}),t.jsx("div",{className:"section-caption",children:"–ü–æ–∫—É–ø–∞–π –≥–µ–º—ã –∑–∞ Telegram Stars ‚≠ê"})]}),e.isTelegram&&!v,ke&&v&&e.userId&&t.jsxs("div",{style:{padding:10,marginBottom:10,borderRadius:10,background:"rgba(34,197,94,0.15)",border:"1px solid rgba(34,197,94,0.5)",fontSize:12},children:[t.jsx("div",{style:{marginBottom:6},children:"–û–ø–ª–∞—Ç–∏–ª–∏, –Ω–æ –≥–µ–º—ã –Ω–µ –ø—Ä–∏—à–ª–∏? –ù–∞–∂–º–∏—Ç–µ ‚Äî –Ω–∞—á–∏—Å–ª–∏–º –ø–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–∫—É–ø–∫–µ:"}),t.jsx("button",{type:"button",className:"btn btn-primary",onClick:async()=>{var i,u,m,l;const s=ke;if(!s)return;const n="packageId"in s?await W(e.userId,{packageId:s.packageId}):await W(e.userId,{gems:s.gems});n!=null&&n.ok?(A(null),x(),setTimeout(x,400),typeof((u=(i=window.Telegram)==null?void 0:i.WebApp)==null?void 0:u.showAlert)=="function"?window.Telegram.WebApp.showAlert("–ì–µ–º—ã –Ω–∞—á–∏—Å–ª–µ–Ω—ã. –ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª—ë–Ω."):alert("–ì–µ–º—ã –Ω–∞—á–∏—Å–ª–µ–Ω—ã.")):typeof((l=(m=window.Telegram)==null?void 0:m.WebApp)==null?void 0:l.showAlert)=="function"?window.Telegram.WebApp.showAlert("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞—á–∏—Å–ª–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑."):alert("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞—á–∏—Å–ª–∏—Ç—å.")},style:{fontSize:12},children:"–Ø –æ–ø–ª–∞—Ç–∏–ª ‚Äî –Ω–∞—á–∏—Å–ª–∏—Ç—å –≥–µ–º—ã"})]}),g&&v&&e.userId&&t.jsxs(t.Fragment,{children:[t.jsx("div",{style:{marginBottom:8},children:t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:async()=>{var u;const s=m=>{var l,o;typeof((o=(l=window.Telegram)==null?void 0:l.WebApp)==null?void 0:o.showAlert)=="function"?window.Telegram.WebApp.showAlert(m):alert(m)},n=r.resources.gems??0;let i=`–û–ü–õ–ê–¢–ê
userId: ${e.userId}
API: ${v}
UI gems: ${n}
`;try{const m=await fetch(`${v}/health`,{credentials:"include"});if(i+=`health: ${m.status}
`,!m.ok){s(i);return}const l=await fetch(`${v}/api/me?userId=${encodeURIComponent(e.userId)}`,{credentials:"include"});if(i+=`api/me: ${l.status}
`,!l.ok){s(i);return}const o=await l.json(),b=((u=o==null?void 0:o.resources)==null?void 0:u.gems)??0;i+=`server gems: ${b}
`,s(i)}catch(m){i+=`error: ${(m==null?void 0:m.message)||String(m)}`,s(i)}},style:{fontSize:12,marginBottom:4},children:"–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ–ø–ª–∞—Ç—ã (admin)"})}),t.jsx("div",{style:{marginBottom:8},children:t.jsx("button",{type:"button",className:"btn btn-secondary",onClick:async()=>{const s=u=>{var m,l;typeof((l=(m=window.Telegram)==null?void 0:m.WebApp)==null?void 0:l.showAlert)=="function"?window.Telegram.WebApp.showAlert(u):alert(u)},n=r.resources;let i=`–ü–†–û–ì–†–ï–°–° (–º–æ–Ω–µ—Ç—ã/—É—Ä–æ–∂–∞–π)
userId: ${e.userId}
API: ${v}
`;i+=`UI coins: ${n.coins??0}
`,i+=`UI tomato: ${n.tomato??0}, cucumber: ${n.cucumber??0}, corn: ${n.corn??0}, watermelon: ${n.watermelon??0}, apple: ${n.apple??0}
`,i+=`UI milk: ${n.milk??0}, egg: ${n.egg??0}, cheese: ${n.cheese??0}, meat: ${n.meat??0}, feathers: ${n.feathers??0}, wool: ${n.wool??0}
`;try{const u=await fetch(`${v}/api/farm/sync`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e.userId,state:r,username:e.username??void 0})});i+=`sync status: ${u.status}
`;const m=await fetch(`${v}/api/me?userId=${encodeURIComponent(e.userId)}`,{credentials:"include"});if(i+=`api/me: ${m.status}
`,!m.ok){s(i);return}const l=await m.json(),o=(l==null?void 0:l.resources)||{};i+=`SERVER coins: ${o.coins??0}
`;const b=["tomato","cucumber","corn","watermelon","apple","milk","egg","cheese","meat","feathers","wool"];let R=!1;for(const oe of b){const Fe=n[oe]??0,He=o[oe]??0;Fe!==He&&(R=!0,i+=`MISMATCH ${oe}: ui=${Fe}, server=${He}
`)}const H=JSON.stringify(r.crops)===JSON.stringify((l==null?void 0:l.crops)??[]),Ge=JSON.stringify(r.animals)===JSON.stringify((l==null?void 0:l.animals)??[]);i+=`crops equal: ${H}
`,i+=`animals equal: ${Ge}
`,R||!H||!Ge?i+=`‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç UI ‚Äî –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.
`:i+=`–†–µ—Å—É—Ä—Å—ã –∏ —Å–ª–æ—Ç—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç ‚Äî –ø—Ä–æ–±–ª–µ–º–∞, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ UI.
`,s(i)}catch(u){i+=`error: ${(u==null?void 0:u.message)||String(u)}`,s(i)}},style:{fontSize:12},children:"–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (admin)"})})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[_.map(s=>t.jsxs("div",{style:{padding:10,borderRadius:14,background:"radial-gradient(circle at top, #166534 0, #020617 60%)",border:"1px solid rgba(34,197,94,0.6)",fontSize:12},children:[t.jsx("div",{style:{fontWeight:600,marginBottom:4},children:s.title}),t.jsxs("div",{style:{marginBottom:6,color:"#9ca3af"},children:["+",s.gems," üíé –∑–∞ ",s.stars," ‚≠ê"]}),t.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>Ls(s.id),disabled:ve===s.id,children:ve===s.id?"–ó–∞–≥—Ä—É–∑–∫–∞...":`–ö—É–ø–∏—Ç—å –∑–∞ ${s.stars} ‚≠ê`})]},s.id)),t.jsxs("div",{style:{padding:10,borderRadius:14,background:"radial-gradient(circle at top, #0f172a 0, #020617 60%)",border:"1px solid rgba(148,163,184,0.5)",fontSize:12,color:"#e5e7eb"},children:[t.jsx("div",{style:{marginBottom:6,fontWeight:600},children:"–°–≤–æ—è —Å—É–º–º–∞"}),t.jsx("div",{style:{marginBottom:6,fontSize:11,color:"#9ca3af"},children:"–í–≤–µ–¥–∏, —Å–∫–æ–ª—å–∫–æ –≥–µ–º–æ–≤ —Ö–æ—á–µ—à—å –∫—É–ø–∏—Ç—å. –ö—É—Ä—Å: 1 ‚≠ê = 5 üíé."}),t.jsxs("div",{style:{display:"flex",gap:8,marginBottom:6},children:[t.jsx("input",{type:"number",min:1,value:we,onChange:s=>Ts(s.target.value),placeholder:"–ù–∞–ø—Ä–∏–º–µ—Ä, 80",style:{flex:1,borderRadius:999,border:"1px solid rgba(148,163,184,0.6)",background:"rgba(15,23,42,0.9)",color:"#e5e7eb",padding:"6px 10px",fontSize:12}}),t.jsxs("div",{style:{alignSelf:"center",fontSize:11,color:"#9ca3af"},children:["‚âà ",Ce||0," ‚≠ê"]})]}),t.jsx("button",{type:"button",className:"btn btn-primary",disabled:!L||je,onClick:Us,children:je?"–ó–∞–≥—Ä—É–∑–∫–∞...":L?`–ö—É–ø–∏—Ç—å ${L} üíé –∑–∞ ${Ce} ‚≠ê`:"–í–≤–µ–¥–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–µ–º–æ–≤"})]}),at()&&t.jsxs("div",{style:{padding:10,borderRadius:14,background:"rgba(59,130,246,0.15)",border:"1px solid rgba(59,130,246,0.5)",fontSize:12,color:"#e5e7eb"},children:[t.jsxs("div",{style:{marginBottom:8},children:["–ù–∞ iPhone –æ–ø–ª–∞—Ç–∞ –∏–∑ –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –º–æ–∂–µ—Ç –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ ‚Äî –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —á–∞—Ç —Å –±–æ—Ç–æ–º (–º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–∫—Ä–æ–µ—Ç—Å—è). –í —á–∞—Ç–µ –≤–≤–µ–¥–∏—Ç–µ ",t.jsx("strong",{children:"/donate"})," –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø–∞–∫–µ—Ç –∏–ª–∏ ¬´–°–≤–æ—è —Å—É–º–º–∞¬ª."]}),t.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>{var n;const s=(n=window.Telegram)==null?void 0:n.WebApp;s!=null&&s.openTelegramLink?(s.openTelegramLink(q),setTimeout(()=>{var i;return(i=s==null?void 0:s.close)==null?void 0:i.call(s)},400)):s!=null&&s.openLink?(s.openLink(q),setTimeout(()=>{var i;return(i=s==null?void 0:s.close)==null?void 0:i.call(s)},400)):window.location.href=q},children:"–û—Ç–∫—Ä—ã—Ç—å –±–æ—Ç–∞ –¥–ª—è –æ–ø–ª–∞—Ç—ã"})]})]})]}),c==="stats"&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"section-title-row",children:[t.jsx("div",{className:"section-title",children:"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"}),t.jsx("div",{className:"section-caption",children:"–¢–≤–æ—è —Ñ–µ—Ä–º–∞ –∏ —Ü–µ–ª–∏"})]}),t.jsxs("div",{style:{padding:12,borderRadius:14,background:"rgba(15,23,42,0.9)",border:"1px solid rgba(148,163,184,0.4)",fontSize:13,marginBottom:10},children:[t.jsx("div",{style:{marginBottom:8,fontWeight:600},children:"–¢–≤–æ—è —Ñ–µ—Ä–º–∞"}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[t.jsxs("div",{children:[t.jsxs("div",{style:{color:"#9ca3af",fontSize:11},children:["–°–æ–±—Ä–∞–Ω–æ —É—Ä–æ–∂–∞—è –∑–∞ –Ω–µ–¥–µ–ª—é (—Ü–µ–ª—å ",ie,")"]}),t.jsx("div",{style:{fontSize:16,fontWeight:600},children:M.harvestsThisWeek.toLocaleString("ru-RU")}),t.jsx("div",{className:"progress-bar",children:t.jsx("div",{className:"progress-fill",style:{width:`${Math.min(1,M.harvestsThisWeek/ie)*100}%`}})})]}),t.jsxs("div",{children:[t.jsxs("div",{style:{color:"#9ca3af",fontSize:11},children:["–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –º–æ–Ω–µ—Ç –∑–∞ –Ω–µ–¥–µ–ª—é (—Ü–µ–ª—å ",ae,")"]}),t.jsx("div",{style:{fontSize:16,fontWeight:600},children:M.coinsEarnedThisWeek.toLocaleString("ru-RU")}),t.jsx("div",{className:"progress-bar",children:t.jsx("div",{className:"progress-fill",style:{width:`${Math.min(1,M.coinsEarnedThisWeek/ae)*100}%`}})})]}),Re&&t.jsxs("button",{type:"button",className:"btn btn-secondary",onClick:Rs,style:{marginTop:4},children:["–ó–∞–±—Ä–∞—Ç—å ",Ue," –º–æ–Ω–µ—Ç (—Ü–∏–∫–ª —Å–±—Ä–æ—Å–∏—Ç—Å—è)"]})]})]}),t.jsxs("div",{style:{padding:10,borderRadius:14,background:"rgba(15,23,42,0.9)",border:"1px solid rgba(34,197,94,0.4)",fontSize:12,marginBottom:10},children:[t.jsx("div",{style:{marginBottom:4,fontWeight:600},children:"–¶–µ–ª—å"}),t.jsxs("div",{style:{marginBottom:4},children:["‚Ä¢ –°–æ–±—Ä–∞—Ç—å –ª—é–±–æ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ 10 —Ä–∞–∑: ",Math.min(z.plantHarvests,10),"/10"]}),t.jsxs("div",{style:{marginBottom:6},children:["‚Ä¢ –ü–æ–∫–æ—Ä–º–∏—Ç—å –ª—é–±–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ 5 —Ä–∞–∑: ",Math.min(z.animalFeeds,5),"/5"]}),t.jsx("button",{type:"button",className:"btn btn-secondary",disabled:!Le,onClick:As,children:"–ó–∞–±—Ä–∞—Ç—å 100 –º–æ–Ω–µ—Ç"})]}),g&&t.jsx(t.Fragment,{children:j?t.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[t.jsxs("div",{style:{padding:12,borderRadius:14,background:"rgba(15,23,42,0.9)",border:"1px solid rgba(148,163,184,0.4)",fontSize:13},children:[t.jsx("div",{style:{marginBottom:6,fontWeight:600},children:"–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä—ã"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[t.jsxs("div",{children:[t.jsx("div",{style:{color:"#9ca3af",fontSize:11},children:"–í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤"}),t.jsx("div",{style:{fontSize:20,fontWeight:600},children:j.totalUsers})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:"#9ca3af",fontSize:11},children:"–ê–∫—Ç–∏–≤–Ω—ã —Å–µ–≥–æ–¥–Ω—è"}),t.jsx("div",{style:{fontSize:20,fontWeight:600},children:j.activeToday})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:"#9ca3af",fontSize:11},children:"–†–µ—Ñ–µ—Ä–∞–ª–æ–≤"}),t.jsx("div",{style:{fontSize:20,fontWeight:600},children:j.totalReferrals})]}),t.jsxs("div",{children:[t.jsx("div",{style:{color:"#9ca3af",fontSize:11},children:"–í—Å–µ–≥–æ –≥–µ–º–æ–≤ üíé"}),t.jsx("div",{style:{fontSize:20,fontWeight:600},children:j.totalGems.toLocaleString("ru-RU")})]})]})]}),t.jsxs("div",{style:{fontSize:10,color:"#6b7280",textAlign:"center"},children:["–û–±–Ω–æ–≤–ª–µ–Ω–æ: ",new Date(j.updatedAt).toLocaleString("ru-RU")]})]}):t.jsx("div",{style:{fontSize:12,color:"#9ca3af"},children:"–ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏..."})})]})]}),t.jsxs("div",{className:"footer",children:[t.jsx("span",{children:gs||ys?"–ß–∞—Å—Ç—å —É—Ä–æ–∂–∞—è —É–∂–µ –≥–æ—Ç–æ–≤–∞ –∫ —Å–±–æ—Ä—É!":"–ó–∞–ø—É—Å—Ç–∏ —Ä–æ—Å—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–π—Å—è –ø–æ–∑–∂–µ."}),t.jsx("span",{children:"v0.6 Youdic"})]})]})})};export{ct as App};
